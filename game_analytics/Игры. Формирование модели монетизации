{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Выпускной проект. Игры - Формирование модели монетизации."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Описание проекта.\n",
    "Нам предоставлены данные активности игроков мобильной игры «Космические братья».  \n",
    " Наша основная задача определить каким образом игра может принести нам деньги и окупить вложения - \n",
    "  составим модель монетизации"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### План работы.\n",
    "[1. Познакомимся с данными](#1.-bullet) \n",
    "\n",
    "  [- 1.1. Импортируем библиотеки](#1.1.-bullet)   \n",
    "  [- 1.2. Откроем и прочитаем данные](#1.2.-bullet)   \n",
    "  [- 1.3. Посмотрим общую информацию и сделаем первые выводы](#1.3.-bullet)   \n",
    "\n",
    "[2. Исследуем данные](#2.-bullet)  \n",
    " \n",
    "  [- 2.1. Проверим дубликаты](#2.1.-bullet)  \n",
    "  [- 2.2. Проверим пропуски](#2.2.-bullet)  \n",
    "  [- 2.3. Опредилим типы данных](#2.3.-bullet)  \n",
    "  [- 2.4. Сделаем выводы](#2.4.-bullet)\n",
    "  \n",
    "[3. Проанализируем данные по активности игрока](#3.-bullet)\n",
    "\n",
    "  [- 3.1. Определим продолжительность активности игрока в день](#3.1.-bullet)  \n",
    "  [- 3.2. Определим ретеншн игроков](#3.2.-bullet)  \n",
    "  [- 3.3. Сравним группы игроков по сценарию прохождения уровня](#3.3.-bullet)  \n",
    "  [- 3.4. Посмотрим какой тип зданий интереснее игроку](#3.4-bullet)  \n",
    "  [- 3.5. Сравним активность групп до и после рекламной кампании](#3.5.-bullet)   \n",
    "  [- 3.6. Сделаем выводы](#3.6.-bullet) \n",
    "  \n",
    "[4. Проверим гипотезы](#4.-bullet)\n",
    "\n",
    "  [- 4.1. Гипотеза о различии времени прохождения уровня групп игроков](#4.1.-bullet)     \n",
    "         \n",
    "[5. Проверим маркетинговые метрики](#5.-bullet)\n",
    "\n",
    "  [- 5.1. Оценим конверсию по рекламным объявлениям](#5.1.-bullet)    \n",
    "  [- 5.2. Оценим затраты на источники трафика](#5.2.-bullet)  \n",
    "  [- 5.3. Построим маркетинговую воронку по дням](#5.3.-bullet)  \n",
    "  [- 5.4. Посмотрим модель безубыточности проекта](#5.4.-bullet)  \n",
    "  [- 5.5. Сделаем выводы](#5.5.-bullet)  \n",
    "  \n",
    "[6. Общие выводы и рекомендации](#6.-bullet)\n",
    "\n",
    "[7. Презентация](#7.-bullet) \n",
    "\n",
    "[8. Дашборд](#8.-bullet)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='1.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1. Познакомимся с данными"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='1.1.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 1.1. Импортируем библиотеки"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd \n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from scipy import stats as st\n",
    "import seaborn as sns\n",
    "import scipy.stats as stats\n",
    "import datetime\n",
    "import plotly.graph_objects as go\n",
    "from plotly.subplots import make_subplots\n",
    "import math as mth\n",
    "plt.style.available\n",
    "plt.style.use('seaborn-pastel')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='1.2.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 1.2. Откроем и прочитаем данные"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Посмотрим файл, собранный по активностям игры."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>event_datetime</th>\n",
       "      <th>event</th>\n",
       "      <th>building_type</th>\n",
       "      <th>user_id</th>\n",
       "      <th>project_type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04 00:00:01</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>55e92310-cb8e-4754-b622-597e124b03de</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-04 00:00:03</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>c07b1c10-f477-44dc-81dc-ec82254b1347</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>6edd42cc-e753-4ff6-a947-2107cd560710</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>92c69003-d60a-444a-827f-8cc51bf6bf4c</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-04 00:00:35</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>cdc6bb92-0ccb-4490-9866-ef142f09139d</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>2020-05-04 00:00:36</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>06c592ca-902d-42bb-bac3-75ce84cca159</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>2020-05-04 00:00:36</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>4fe0f101-694b-4e31-9740-d1d87f7208ea</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>2020-05-04 00:00:38</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>beb8ca15-33a9-465d-b47b-89aa96f89c9a</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>2020-05-04 00:00:44</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>65a92713-5969-48b1-8945-bfefa5063887</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>2020-05-04 00:01:33</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>fa352362-d258-472c-b295-2796ccc39fa3</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        event_datetime     event  building_type  \\\n",
       "0  2020-05-04 00:00:01  building  assembly_shop   \n",
       "1  2020-05-04 00:00:03  building  assembly_shop   \n",
       "2  2020-05-04 00:00:16  building  assembly_shop   \n",
       "3  2020-05-04 00:00:16  building  assembly_shop   \n",
       "4  2020-05-04 00:00:35  building  assembly_shop   \n",
       "5  2020-05-04 00:00:36  building  assembly_shop   \n",
       "6  2020-05-04 00:00:36  building  assembly_shop   \n",
       "7  2020-05-04 00:00:38  building  assembly_shop   \n",
       "8  2020-05-04 00:00:44  building  assembly_shop   \n",
       "9  2020-05-04 00:01:33  building  assembly_shop   \n",
       "\n",
       "                                user_id project_type  \n",
       "0  55e92310-cb8e-4754-b622-597e124b03de          NaN  \n",
       "1  c07b1c10-f477-44dc-81dc-ec82254b1347          NaN  \n",
       "2  6edd42cc-e753-4ff6-a947-2107cd560710          NaN  \n",
       "3  92c69003-d60a-444a-827f-8cc51bf6bf4c          NaN  \n",
       "4  cdc6bb92-0ccb-4490-9866-ef142f09139d          NaN  \n",
       "5  06c592ca-902d-42bb-bac3-75ce84cca159          NaN  \n",
       "6  4fe0f101-694b-4e31-9740-d1d87f7208ea          NaN  \n",
       "7  beb8ca15-33a9-465d-b47b-89aa96f89c9a          NaN  \n",
       "8  65a92713-5969-48b1-8945-bfefa5063887          NaN  \n",
       "9  fa352362-d258-472c-b295-2796ccc39fa3          NaN  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games_data = pd.read_csv('/datasets/game_actions.csv')\n",
    "games_data.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Первый вывод - есть пустые значения.  \n",
    " Далее оценим их значимость в блоке по исследованиям."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Посмотрим датасет с данными по стоимостям кликов "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>day</th>\n",
       "      <th>cost</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>548.354480</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-05</td>\n",
       "      <td>260.185754</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-06</td>\n",
       "      <td>177.982200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-07</td>\n",
       "      <td>111.766796</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-08</td>\n",
       "      <td>68.009276</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-09</td>\n",
       "      <td>38.723350</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>943.204717</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>502.925451</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "      <td>2020-05-05</td>\n",
       "      <td>313.970984</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  source         day        cost\n",
       "0           facebook_ads  2020-05-03  935.882786\n",
       "1           facebook_ads  2020-05-04  548.354480\n",
       "2           facebook_ads  2020-05-05  260.185754\n",
       "3           facebook_ads  2020-05-06  177.982200\n",
       "4           facebook_ads  2020-05-07  111.766796\n",
       "5           facebook_ads  2020-05-08   68.009276\n",
       "6           facebook_ads  2020-05-09   38.723350\n",
       "7  instagram_new_adverts  2020-05-03  943.204717\n",
       "8  instagram_new_adverts  2020-05-04  502.925451\n",
       "9  instagram_new_adverts  2020-05-05  313.970984"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adv_data = pd.read_csv('/datasets/ad_costs.csv')\n",
    "adv_data.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Вот это косты! Данные понятны и лаконичны.  \n",
    " Посмотрим сразу источники"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['facebook_ads', 'instagram_new_adverts', 'yandex_direct',\n",
       "       'youtube_channel_reklama'], dtype=object)"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adv_data['source'].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Нет рекламы в гугле) Всего 4 источника трафика.  \n",
    " Далее сравним их по качеству и количеству трафика, объединив со следующим датасетом."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>source</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0001f83c-c6ac-4621-b7f0-8a28b283ac30</td>\n",
       "      <td>facebook_ads</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>00151b4f-ba38-44a8-a650-d7cf130a0105</td>\n",
       "      <td>yandex_direct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>001aaea6-3d14-43f1-8ca8-7f48820f17aa</td>\n",
       "      <td>youtube_channel_reklama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>001d39dc-366c-4021-9604-6a3b9ff01e25</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>002f508f-67b6-479f-814b-b05f00d4e995</td>\n",
       "      <td>facebook_ads</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>003b80c6-4164-4157-bb2a-03d0181d39c4</td>\n",
       "      <td>yandex_direct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>003ee7e8-6356-4286-a715-62f22a18d2a1</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>004074f8-251a-4776-922c-8348dca1a2f6</td>\n",
       "      <td>facebook_ads</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>00440efd-aa50-4b4b-aae8-ffcd1782729d</td>\n",
       "      <td>facebook_ads</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>00464e5e-28ed-4be6-bf44-517ef7b3937b</td>\n",
       "      <td>yandex_direct</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                user_id                   source\n",
       "0  0001f83c-c6ac-4621-b7f0-8a28b283ac30             facebook_ads\n",
       "1  00151b4f-ba38-44a8-a650-d7cf130a0105            yandex_direct\n",
       "2  001aaea6-3d14-43f1-8ca8-7f48820f17aa  youtube_channel_reklama\n",
       "3  001d39dc-366c-4021-9604-6a3b9ff01e25    instagram_new_adverts\n",
       "4  002f508f-67b6-479f-814b-b05f00d4e995             facebook_ads\n",
       "5  003b80c6-4164-4157-bb2a-03d0181d39c4            yandex_direct\n",
       "6  003ee7e8-6356-4286-a715-62f22a18d2a1    instagram_new_adverts\n",
       "7  004074f8-251a-4776-922c-8348dca1a2f6             facebook_ads\n",
       "8  00440efd-aa50-4b4b-aae8-ffcd1782729d             facebook_ads\n",
       "9  00464e5e-28ed-4be6-bf44-517ef7b3937b            yandex_direct"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_source_data = pd.read_csv('/datasets/user_source.csv')\n",
    "user_source_data.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Объединим сразу два последних датасета"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>day</th>\n",
       "      <th>cost</th>\n",
       "      <th>user_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>0001f83c-c6ac-4621-b7f0-8a28b283ac30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>002f508f-67b6-479f-814b-b05f00d4e995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>004074f8-251a-4776-922c-8348dca1a2f6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>00440efd-aa50-4b4b-aae8-ffcd1782729d</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>00965328-5e54-453f-b11b-52f8ae9ae80b</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>0099a74d-bafc-404f-ae47-5c901a06d108</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>00b45f70-fc28-4af4-9867-487e0a2906e7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>00d48589-0a24-44cb-93c5-a5007c0c1a84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>00eed4e1-a7bd-46c8-a563-862ce3c916d6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>00ef3286-af82-49d8-9710-d4a087912bfc</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         source         day        cost                               user_id\n",
       "0  facebook_ads  2020-05-03  935.882786  0001f83c-c6ac-4621-b7f0-8a28b283ac30\n",
       "1  facebook_ads  2020-05-03  935.882786  002f508f-67b6-479f-814b-b05f00d4e995\n",
       "2  facebook_ads  2020-05-03  935.882786  004074f8-251a-4776-922c-8348dca1a2f6\n",
       "3  facebook_ads  2020-05-03  935.882786  00440efd-aa50-4b4b-aae8-ffcd1782729d\n",
       "4  facebook_ads  2020-05-03  935.882786  00965328-5e54-453f-b11b-52f8ae9ae80b\n",
       "5  facebook_ads  2020-05-03  935.882786  0099a74d-bafc-404f-ae47-5c901a06d108\n",
       "6  facebook_ads  2020-05-03  935.882786  00b45f70-fc28-4af4-9867-487e0a2906e7\n",
       "7  facebook_ads  2020-05-03  935.882786  00d48589-0a24-44cb-93c5-a5007c0c1a84\n",
       "8  facebook_ads  2020-05-03  935.882786  00eed4e1-a7bd-46c8-a563-862ce3c916d6\n",
       "9  facebook_ads  2020-05-03  935.882786  00ef3286-af82-49d8-9710-d4a087912bfc"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adv_all_data = adv_data.merge(user_source_data, on='source', how='left')\n",
    "adv_all_data.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Датасеты готовы к работе"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='1.3.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 1.3. Посмотрим общую информацию и сделаем первые выводы  \n",
    " Посмотрим первый датасет"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 135640 entries, 0 to 135639\n",
      "Data columns (total 5 columns):\n",
      "event_datetime    135640 non-null object\n",
      "event             135640 non-null object\n",
      "building_type     127957 non-null object\n",
      "user_id           135640 non-null object\n",
      "project_type      1866 non-null object\n",
      "dtypes: object(5)\n",
      "memory usage: 5.2+ MB\n"
     ]
    }
   ],
   "source": [
    "games_data.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Типы данных нуждаются в проработке.  \n",
    " Есть пропущенные значения."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Откроем второй датасет"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 95032 entries, 0 to 95031\n",
      "Data columns (total 4 columns):\n",
      "source     95032 non-null object\n",
      "day        95032 non-null object\n",
      "cost       95032 non-null float64\n",
      "user_id    95032 non-null object\n",
      "dtypes: float64(1), object(3)\n",
      "memory usage: 3.6+ MB\n"
     ]
    }
   ],
   "source": [
    "adv_all_data.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Типы данных нужно будет заменить.  \n",
    " Посмотрим долю взаимодействий с рекламой"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### Выводы по знакомству с данными  \n",
    " 1. Необходимо заменить типы данных\n",
    " 2. Данные достаточно объемные\n",
    " 3. Основной датасет 135640 в сыром виде (до проработки дубликатов и пропусков)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='2.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2. Исследуем данные"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='2.1.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 2.1. Проверим дубликаты"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games_data.duplicated().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Один дубликат - удалим его"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games_data = games_data.drop_duplicates()\n",
    "games_data.duplicated().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adv_all_data.duplicated().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "От дубликаттов избавились в основном датасете.  \n",
    " В данных по маркетинговым затратам дубликаты отсутствуют."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='2.2.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 2.2. Проверим пропуски"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "event_datetime         0\n",
       "event                  0\n",
       "building_type       7683\n",
       "user_id                0\n",
       "project_type      133773\n",
       "dtype: int64"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games_data.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Пропуска в колонке project_type - тип реализованного проекта.\n",
    "Предположу, что игра в процессе и проекты еще не реализованы игроками.\n",
    "оставим данные без изменений.\n",
    "Пропуски в столбце building_type возможно говорят об игроках,  \n",
    " кто завершил первый уровень любым способом.  \n",
    "  Проверим это"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['finished_stage_1'], dtype=object)"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games_data_nan = games_data[games_data['building_type'].isnull()].head()\n",
    "games_data_nan['event'].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Мы убедились, что пропуски в типе постройки соответствуют ивенту окончил первый уровень\n",
    "      \n",
    "Проверим на пропуски датасет с данными по рекламной активности"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "source     0\n",
       "day        0\n",
       "cost       0\n",
       "user_id    0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adv_all_data.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Пропусков нет. Приступим к типам данных."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='2.3.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 2.3. Опредилим типы данных"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 135639 entries, 0 to 135639\n",
      "Data columns (total 5 columns):\n",
      "event_datetime    135639 non-null object\n",
      "event             135639 non-null object\n",
      "building_type     127956 non-null object\n",
      "user_id           135639 non-null object\n",
      "project_type      1866 non-null object\n",
      "dtypes: object(5)\n",
      "memory usage: 6.2+ MB\n"
     ]
    }
   ],
   "source": [
    "games_data.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "В датасете с игровой активностью заменим:  \n",
    "1. Тип данных у даты сделаем датой \n",
    "2. Остальные типы данных оставим без изменений "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 135639 entries, 0 to 135639\n",
      "Data columns (total 5 columns):\n",
      "event_datetime    135639 non-null datetime64[ns]\n",
      "event             135639 non-null object\n",
      "building_type     127956 non-null object\n",
      "user_id           135639 non-null object\n",
      "project_type      1866 non-null object\n",
      "dtypes: datetime64[ns](1), object(4)\n",
      "memory usage: 6.2+ MB\n"
     ]
    }
   ],
   "source": [
    "games_data['event_datetime'] = pd.to_datetime(games_data['event_datetime'])\n",
    "games_data.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 95032 entries, 0 to 95031\n",
      "Data columns (total 4 columns):\n",
      "source     95032 non-null object\n",
      "day        95032 non-null object\n",
      "cost       95032 non-null float64\n",
      "user_id    95032 non-null object\n",
      "dtypes: float64(1), object(3)\n",
      "memory usage: 3.6+ MB\n"
     ]
    }
   ],
   "source": [
    "adv_all_data.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 95032 entries, 0 to 95031\n",
      "Data columns (total 4 columns):\n",
      "source     95032 non-null object\n",
      "day        95032 non-null datetime64[ns]\n",
      "cost       95032 non-null float64\n",
      "user_id    95032 non-null object\n",
      "dtypes: datetime64[ns](1), float64(1), object(2)\n",
      "memory usage: 3.6+ MB\n"
     ]
    }
   ],
   "source": [
    "adv_all_data['day'] = pd.to_datetime(adv_all_data['day'])\n",
    "adv_all_data.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='2.4.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 2.4. Сделаем выводы"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Данные готовы к анализу:  \n",
    "1. Тип данных заменили  \n",
    "2. От дубликата избавились \n",
    "3. Пропуска оставим, их 6% всего - и они в столбцах показывающих активность (выбор типа постройки) -  \n",
    " следовательно считать их техническими ошибками не стоит - мы доказали, что это те,  \n",
    "  кто каким-либо способом завершил первый уровень."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='3.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3. Проанализируем данные по активности игрока  \n",
    " В данном блоке активно будем рассматривать датасет по игровой активности.  \n",
    " Выделим отдельно столбец с датой"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>event_datetime</th>\n",
       "      <th>event</th>\n",
       "      <th>building_type</th>\n",
       "      <th>user_id</th>\n",
       "      <th>project_type</th>\n",
       "      <th>date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04 00:00:01</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>55e92310-cb8e-4754-b622-597e124b03de</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-04 00:00:03</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>c07b1c10-f477-44dc-81dc-ec82254b1347</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>6edd42cc-e753-4ff6-a947-2107cd560710</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>92c69003-d60a-444a-827f-8cc51bf6bf4c</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-04 00:00:35</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>cdc6bb92-0ccb-4490-9866-ef142f09139d</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       event_datetime     event  building_type  \\\n",
       "0 2020-05-04 00:00:01  building  assembly_shop   \n",
       "1 2020-05-04 00:00:03  building  assembly_shop   \n",
       "2 2020-05-04 00:00:16  building  assembly_shop   \n",
       "3 2020-05-04 00:00:16  building  assembly_shop   \n",
       "4 2020-05-04 00:00:35  building  assembly_shop   \n",
       "\n",
       "                                user_id project_type       date  \n",
       "0  55e92310-cb8e-4754-b622-597e124b03de          NaN 2020-05-04  \n",
       "1  c07b1c10-f477-44dc-81dc-ec82254b1347          NaN 2020-05-04  \n",
       "2  6edd42cc-e753-4ff6-a947-2107cd560710          NaN 2020-05-04  \n",
       "3  92c69003-d60a-444a-827f-8cc51bf6bf4c          NaN 2020-05-04  \n",
       "4  cdc6bb92-0ccb-4490-9866-ef142f09139d          NaN 2020-05-04  "
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games_data['date'] = games_data['event_datetime'].astype('datetime64[D]')\n",
    "#games_data['minute'] = games_data['event_datetime'].dt.hour\n",
    "games_data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='3.1.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3.1. Определим продолжительность активности игрока в день"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>n_event</th>\n",
       "      <th>n_user</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>2020-05-10</td>\n",
       "      <td>15207</td>\n",
       "      <td>9219</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>2020-05-09</td>\n",
       "      <td>13129</td>\n",
       "      <td>8394</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-08</td>\n",
       "      <td>12059</td>\n",
       "      <td>7891</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-07</td>\n",
       "      <td>10858</td>\n",
       "      <td>7384</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-06</td>\n",
       "      <td>9925</td>\n",
       "      <td>6854</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-05</td>\n",
       "      <td>9055</td>\n",
       "      <td>6382</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>2020-05-11</td>\n",
       "      <td>8185</td>\n",
       "      <td>5995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>8171</td>\n",
       "      <td>5860</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>2020-05-12</td>\n",
       "      <td>7918</td>\n",
       "      <td>5776</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>2020-05-13</td>\n",
       "      <td>7624</td>\n",
       "      <td>5632</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        date  n_event  n_user\n",
       "6 2020-05-10    15207    9219\n",
       "5 2020-05-09    13129    8394\n",
       "4 2020-05-08    12059    7891\n",
       "3 2020-05-07    10858    7384\n",
       "2 2020-05-06     9925    6854\n",
       "1 2020-05-05     9055    6382\n",
       "7 2020-05-11     8185    5995\n",
       "0 2020-05-04     8171    5860\n",
       "8 2020-05-12     7918    5776\n",
       "9 2020-05-13     7624    5632"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_activity = games_data.pivot_table(index='date', values= 'user_id',\\\n",
    "                                       aggfunc= {'count', 'nunique'}).reset_index()\n",
    "user_activity.columns = ['date', 'n_event', 'n_user']\n",
    "user_activity.sort_values(by='n_user', ascending = False).head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Добавим столбец, чтобы увидеть сколько событий на 1 одного игрока приходится в день "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>n_event</th>\n",
       "      <th>n_user</th>\n",
       "      <th>session_per_user</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>2020-05-10</td>\n",
       "      <td>15207</td>\n",
       "      <td>9219</td>\n",
       "      <td>1.649528</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>2020-05-09</td>\n",
       "      <td>13129</td>\n",
       "      <td>8394</td>\n",
       "      <td>1.564093</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-08</td>\n",
       "      <td>12059</td>\n",
       "      <td>7891</td>\n",
       "      <td>1.528197</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-07</td>\n",
       "      <td>10858</td>\n",
       "      <td>7384</td>\n",
       "      <td>1.470477</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-06</td>\n",
       "      <td>9925</td>\n",
       "      <td>6854</td>\n",
       "      <td>1.448060</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-05</td>\n",
       "      <td>9055</td>\n",
       "      <td>6382</td>\n",
       "      <td>1.418834</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>2020-05-11</td>\n",
       "      <td>8185</td>\n",
       "      <td>5995</td>\n",
       "      <td>1.365304</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>8171</td>\n",
       "      <td>5860</td>\n",
       "      <td>1.394369</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>2020-05-12</td>\n",
       "      <td>7918</td>\n",
       "      <td>5776</td>\n",
       "      <td>1.370845</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>2020-05-13</td>\n",
       "      <td>7624</td>\n",
       "      <td>5632</td>\n",
       "      <td>1.353693</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        date  n_event  n_user  session_per_user\n",
       "6 2020-05-10    15207    9219          1.649528\n",
       "5 2020-05-09    13129    8394          1.564093\n",
       "4 2020-05-08    12059    7891          1.528197\n",
       "3 2020-05-07    10858    7384          1.470477\n",
       "2 2020-05-06     9925    6854          1.448060\n",
       "1 2020-05-05     9055    6382          1.418834\n",
       "7 2020-05-11     8185    5995          1.365304\n",
       "0 2020-05-04     8171    5860          1.394369\n",
       "8 2020-05-12     7918    5776          1.370845\n",
       "9 2020-05-13     7624    5632          1.353693"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_activity['session_per_user'] = user_activity['n_event']/user_activity['n_user']\n",
    "user_activity.sort_values(by='n_user', ascending = False).head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "В день игрок совершает за 1 день более 1 события.  \n",
    " Самые активные игровые дни это с 8 мая по 10 мая.  \n",
    "  Дни возле выходного - на работу никому не надо - все играют.  \n",
    "   Вычислим теперь среднее время игрока в игре за весь период наблюдений."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Определим продолжнительность игры по дням"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>event</th>\n",
       "      <th>first</th>\n",
       "      <th>last</th>\n",
       "      <th>date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0001f83c-c6ac-4621-b7f0-8a28b283ac30</td>\n",
       "      <td>building</td>\n",
       "      <td>2020-05-06 01:07:37</td>\n",
       "      <td>2020-05-20 11:26:06</td>\n",
       "      <td>2020-05-06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>00151b4f-ba38-44a8-a650-d7cf130a0105</td>\n",
       "      <td>building</td>\n",
       "      <td>2020-05-06 03:09:12</td>\n",
       "      <td>2020-05-18 10:46:52</td>\n",
       "      <td>2020-05-06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>001aaea6-3d14-43f1-8ca8-7f48820f17aa</td>\n",
       "      <td>building</td>\n",
       "      <td>2020-05-05 18:08:52</td>\n",
       "      <td>2020-05-14 09:21:27</td>\n",
       "      <td>2020-05-05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>001d39dc-366c-4021-9604-6a3b9ff01e25</td>\n",
       "      <td>building</td>\n",
       "      <td>2020-05-05 21:02:05</td>\n",
       "      <td>2020-05-12 04:14:25</td>\n",
       "      <td>2020-05-05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>001d39dc-366c-4021-9604-6a3b9ff01e25</td>\n",
       "      <td>finished_stage_1</td>\n",
       "      <td>2020-05-12 07:40:47</td>\n",
       "      <td>2020-05-12 07:40:47</td>\n",
       "      <td>2020-05-12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>21254</td>\n",
       "      <td>fffb626c-5ab6-47c9-8113-2062a2f18494</td>\n",
       "      <td>finished_stage_1</td>\n",
       "      <td>2020-05-12 13:01:52</td>\n",
       "      <td>2020-05-12 13:01:52</td>\n",
       "      <td>2020-05-12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>21255</td>\n",
       "      <td>ffff194a-56b7-4c12-860d-3485242ae7f5</td>\n",
       "      <td>building</td>\n",
       "      <td>2020-05-04 20:28:28</td>\n",
       "      <td>2020-05-11 22:04:30</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>21256</td>\n",
       "      <td>ffff69cc-fec1-4fd3-9f98-93be1112a6b8</td>\n",
       "      <td>building</td>\n",
       "      <td>2020-05-08 06:57:30</td>\n",
       "      <td>2020-05-25 07:09:53</td>\n",
       "      <td>2020-05-08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>21257</td>\n",
       "      <td>ffff69cc-fec1-4fd3-9f98-93be1112a6b8</td>\n",
       "      <td>finished_stage_1</td>\n",
       "      <td>2020-05-25 14:05:51</td>\n",
       "      <td>2020-05-25 14:05:51</td>\n",
       "      <td>2020-05-25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>21258</td>\n",
       "      <td>ffff69cc-fec1-4fd3-9f98-93be1112a6b8</td>\n",
       "      <td>project</td>\n",
       "      <td>2020-05-25 03:55:06</td>\n",
       "      <td>2020-05-25 03:55:06</td>\n",
       "      <td>2020-05-25</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>21259 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                    user_id             event  \\\n",
       "0      0001f83c-c6ac-4621-b7f0-8a28b283ac30          building   \n",
       "1      00151b4f-ba38-44a8-a650-d7cf130a0105          building   \n",
       "2      001aaea6-3d14-43f1-8ca8-7f48820f17aa          building   \n",
       "3      001d39dc-366c-4021-9604-6a3b9ff01e25          building   \n",
       "4      001d39dc-366c-4021-9604-6a3b9ff01e25  finished_stage_1   \n",
       "...                                     ...               ...   \n",
       "21254  fffb626c-5ab6-47c9-8113-2062a2f18494  finished_stage_1   \n",
       "21255  ffff194a-56b7-4c12-860d-3485242ae7f5          building   \n",
       "21256  ffff69cc-fec1-4fd3-9f98-93be1112a6b8          building   \n",
       "21257  ffff69cc-fec1-4fd3-9f98-93be1112a6b8  finished_stage_1   \n",
       "21258  ffff69cc-fec1-4fd3-9f98-93be1112a6b8           project   \n",
       "\n",
       "                    first                last        date  \n",
       "0     2020-05-06 01:07:37 2020-05-20 11:26:06  2020-05-06  \n",
       "1     2020-05-06 03:09:12 2020-05-18 10:46:52  2020-05-06  \n",
       "2     2020-05-05 18:08:52 2020-05-14 09:21:27  2020-05-05  \n",
       "3     2020-05-05 21:02:05 2020-05-12 04:14:25  2020-05-05  \n",
       "4     2020-05-12 07:40:47 2020-05-12 07:40:47  2020-05-12  \n",
       "...                   ...                 ...         ...  \n",
       "21254 2020-05-12 13:01:52 2020-05-12 13:01:52  2020-05-12  \n",
       "21255 2020-05-04 20:28:28 2020-05-11 22:04:30  2020-05-04  \n",
       "21256 2020-05-08 06:57:30 2020-05-25 07:09:53  2020-05-08  \n",
       "21257 2020-05-25 14:05:51 2020-05-25 14:05:51  2020-05-25  \n",
       "21258 2020-05-25 03:55:06 2020-05-25 03:55:06  2020-05-25  \n",
       "\n",
       "[21259 rows x 5 columns]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "event_data_1 = games_data.groupby(['user_id', 'event'])['event_datetime'].agg(['first','last']).reset_index()\n",
    "event_data_1['date'] = event_data_1['first'].dt.date\n",
    "event_data_1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>delta</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>43242.185122</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-05</td>\n",
       "      <td>43250.159334</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-06</td>\n",
       "      <td>44119.470016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-07</td>\n",
       "      <td>44062.334821</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-08</td>\n",
       "      <td>40596.404463</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         date         delta\n",
       "0  2020-05-04  43242.185122\n",
       "1  2020-05-05  43250.159334\n",
       "2  2020-05-06  44119.470016\n",
       "3  2020-05-07  44062.334821\n",
       "4  2020-05-08  40596.404463"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "event_data_1['delta'] = (event_data_1['last'] - event_data_1['first']).dt.seconds\n",
    "#event_data_1_gr = event_data_1.groupby('event')['delta', 'user_id'].agg({'delta':'mean','user_id':'count'})\n",
    "event_data_1_gr = event_data_1.groupby('date')['delta'].mean().reset_index()\n",
    "event_data_1_gr.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "8445.899355209604"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "event_data_1_gr['delta'].mean()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Видим, что наши игроки проводят за игрой 2,3 часа в день в среднем."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Комментарий: перебрала 4 способа как высчитать время - ниже в 2х ячейках  \n",
    "     оставлю варианты расчета - где видно, что на каждую пару событий действительно приходится много времени"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>event</th>\n",
       "      <th>start_time</th>\n",
       "      <th>finish_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>building</td>\n",
       "      <td>2020-05-04 00:00:01</td>\n",
       "      <td>2020-05-04 19:47:29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>finished_stage_1</td>\n",
       "      <td>2020-05-04 19:47:29</td>\n",
       "      <td>2020-05-04 19:47:46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>building</td>\n",
       "      <td>2020-05-04 19:47:46</td>\n",
       "      <td>2020-05-05 13:22:09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>finished_stage_1</td>\n",
       "      <td>2020-05-05 13:22:09</td>\n",
       "      <td>2020-05-05 13:22:24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>building</td>\n",
       "      <td>2020-05-05 13:22:24</td>\n",
       "      <td>2020-05-05 18:54:37</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              event          start_time         finish_time\n",
       "0          building 2020-05-04 00:00:01 2020-05-04 19:47:29\n",
       "1  finished_stage_1 2020-05-04 19:47:29 2020-05-04 19:47:46\n",
       "2          building 2020-05-04 19:47:46 2020-05-05 13:22:09\n",
       "3  finished_stage_1 2020-05-05 13:22:09 2020-05-05 13:22:24\n",
       "4          building 2020-05-05 13:22:24 2020-05-05 18:54:37"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "current_event = None\n",
    "result = []\n",
    "for event, time in zip(games_data['event'], games_data['event_datetime']):\n",
    "    if event != current_event:\n",
    "        if current_event is not None:\n",
    "            result.append([current_event, start_time, time])\n",
    "        current_event, start_time = event, time\n",
    "event_data = pd.DataFrame(result, columns=['event','start_time','finish_time'])\n",
    "event_data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Таким образом мы получили, что в день игрок c нами проводит в среднем 2,3 часа.  \n",
    " Наблюдаем так же, что с течением времени объемы времени в игре увеличиваются - игра увлекает пользователя"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='3.2.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3.2. Определим ретеншн игроков\n",
    " Для этого создадим таблицу по данным на первый и послений вход игроков,  \n",
    "  объединим ее с датасетом и выделим даты для первого и последнего визита"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>event_datetime</th>\n",
       "      <th>event</th>\n",
       "      <th>building_type</th>\n",
       "      <th>user_id</th>\n",
       "      <th>project_type</th>\n",
       "      <th>date</th>\n",
       "      <th>first_visit</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04 00:00:01</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>55e92310-cb8e-4754-b622-597e124b03de</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-04 00:00:03</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>c07b1c10-f477-44dc-81dc-ec82254b1347</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>6edd42cc-e753-4ff6-a947-2107cd560710</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>92c69003-d60a-444a-827f-8cc51bf6bf4c</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-04 00:00:35</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>cdc6bb92-0ccb-4490-9866-ef142f09139d</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:35</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       event_datetime     event  building_type  \\\n",
       "0 2020-05-04 00:00:01  building  assembly_shop   \n",
       "1 2020-05-04 00:00:03  building  assembly_shop   \n",
       "2 2020-05-04 00:00:16  building  assembly_shop   \n",
       "3 2020-05-04 00:00:16  building  assembly_shop   \n",
       "4 2020-05-04 00:00:35  building  assembly_shop   \n",
       "\n",
       "                                user_id project_type       date  \\\n",
       "0  55e92310-cb8e-4754-b622-597e124b03de          NaN 2020-05-04   \n",
       "1  c07b1c10-f477-44dc-81dc-ec82254b1347          NaN 2020-05-04   \n",
       "2  6edd42cc-e753-4ff6-a947-2107cd560710          NaN 2020-05-04   \n",
       "3  92c69003-d60a-444a-827f-8cc51bf6bf4c          NaN 2020-05-04   \n",
       "4  cdc6bb92-0ccb-4490-9866-ef142f09139d          NaN 2020-05-04   \n",
       "\n",
       "          first_visit  \n",
       "0 2020-05-04 00:00:01  \n",
       "1 2020-05-04 00:00:03  \n",
       "2 2020-05-04 00:00:16  \n",
       "3 2020-05-04 00:00:16  \n",
       "4 2020-05-04 00:00:35  "
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "first_visit = games_data.groupby('user_id')['event_datetime'].min()\n",
    "first_visit.name = 'first_visit'\n",
    "games_data = games_data.join(first_visit, on='user_id')\n",
    "games_data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Присвоем номер дня старту первой игры"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>event_datetime</th>\n",
       "      <th>event</th>\n",
       "      <th>building_type</th>\n",
       "      <th>user_id</th>\n",
       "      <th>project_type</th>\n",
       "      <th>date</th>\n",
       "      <th>first_visit</th>\n",
       "      <th>visit_date</th>\n",
       "      <th>first_visit_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04 00:00:01</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>55e92310-cb8e-4754-b622-597e124b03de</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:01</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-04 00:00:03</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>c07b1c10-f477-44dc-81dc-ec82254b1347</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:03</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>6edd42cc-e753-4ff6-a947-2107cd560710</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>92c69003-d60a-444a-827f-8cc51bf6bf4c</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-04 00:00:35</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>cdc6bb92-0ccb-4490-9866-ef142f09139d</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:35</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       event_datetime     event  building_type  \\\n",
       "0 2020-05-04 00:00:01  building  assembly_shop   \n",
       "1 2020-05-04 00:00:03  building  assembly_shop   \n",
       "2 2020-05-04 00:00:16  building  assembly_shop   \n",
       "3 2020-05-04 00:00:16  building  assembly_shop   \n",
       "4 2020-05-04 00:00:35  building  assembly_shop   \n",
       "\n",
       "                                user_id project_type       date  \\\n",
       "0  55e92310-cb8e-4754-b622-597e124b03de          NaN 2020-05-04   \n",
       "1  c07b1c10-f477-44dc-81dc-ec82254b1347          NaN 2020-05-04   \n",
       "2  6edd42cc-e753-4ff6-a947-2107cd560710          NaN 2020-05-04   \n",
       "3  92c69003-d60a-444a-827f-8cc51bf6bf4c          NaN 2020-05-04   \n",
       "4  cdc6bb92-0ccb-4490-9866-ef142f09139d          NaN 2020-05-04   \n",
       "\n",
       "          first_visit visit_date first_visit_date  \n",
       "0 2020-05-04 00:00:01 2020-05-04       2020-05-04  \n",
       "1 2020-05-04 00:00:03 2020-05-04       2020-05-04  \n",
       "2 2020-05-04 00:00:16 2020-05-04       2020-05-04  \n",
       "3 2020-05-04 00:00:16 2020-05-04       2020-05-04  \n",
       "4 2020-05-04 00:00:35 2020-05-04       2020-05-04  "
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games_data['visit_date'] = games_data['event_datetime'].astype('datetime64[D]')\n",
    "games_data['first_visit_date'] = games_data['first_visit'].astype('datetime64[D]')\n",
    "games_data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Посмотрим время в игре"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>event_datetime</th>\n",
       "      <th>event</th>\n",
       "      <th>building_type</th>\n",
       "      <th>user_id</th>\n",
       "      <th>project_type</th>\n",
       "      <th>date</th>\n",
       "      <th>first_visit</th>\n",
       "      <th>visit_date</th>\n",
       "      <th>first_visit_date</th>\n",
       "      <th>cohort_lifetime</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04 00:00:01</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>55e92310-cb8e-4754-b622-597e124b03de</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:01</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-04 00:00:03</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>c07b1c10-f477-44dc-81dc-ec82254b1347</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:03</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>6edd42cc-e753-4ff6-a947-2107cd560710</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>92c69003-d60a-444a-827f-8cc51bf6bf4c</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-04 00:00:35</td>\n",
       "      <td>building</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>cdc6bb92-0ccb-4490-9866-ef142f09139d</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04 00:00:35</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       event_datetime     event  building_type  \\\n",
       "0 2020-05-04 00:00:01  building  assembly_shop   \n",
       "1 2020-05-04 00:00:03  building  assembly_shop   \n",
       "2 2020-05-04 00:00:16  building  assembly_shop   \n",
       "3 2020-05-04 00:00:16  building  assembly_shop   \n",
       "4 2020-05-04 00:00:35  building  assembly_shop   \n",
       "\n",
       "                                user_id project_type       date  \\\n",
       "0  55e92310-cb8e-4754-b622-597e124b03de          NaN 2020-05-04   \n",
       "1  c07b1c10-f477-44dc-81dc-ec82254b1347          NaN 2020-05-04   \n",
       "2  6edd42cc-e753-4ff6-a947-2107cd560710          NaN 2020-05-04   \n",
       "3  92c69003-d60a-444a-827f-8cc51bf6bf4c          NaN 2020-05-04   \n",
       "4  cdc6bb92-0ccb-4490-9866-ef142f09139d          NaN 2020-05-04   \n",
       "\n",
       "          first_visit visit_date first_visit_date  cohort_lifetime  \n",
       "0 2020-05-04 00:00:01 2020-05-04       2020-05-04                0  \n",
       "1 2020-05-04 00:00:03 2020-05-04       2020-05-04                0  \n",
       "2 2020-05-04 00:00:16 2020-05-04       2020-05-04                0  \n",
       "3 2020-05-04 00:00:16 2020-05-04       2020-05-04                0  \n",
       "4 2020-05-04 00:00:35 2020-05-04       2020-05-04                0  "
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games_data['cohort_lifetime'] = games_data['visit_date'] - games_data['first_visit_date']\n",
    "games_data['cohort_lifetime'] = games_data['cohort_lifetime'] / np.timedelta64(1,'D')\n",
    "games_data['cohort_lifetime'] = games_data['cohort_lifetime'].apply(np.round).astype('int') \n",
    "games_data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Соберем когорты"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>first_visit_date</th>\n",
       "      <th>cohort_lifetime</th>\n",
       "      <th>user_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>0</td>\n",
       "      <td>5860</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>1</td>\n",
       "      <td>3021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>2</td>\n",
       "      <td>3204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>3</td>\n",
       "      <td>3412</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>4</td>\n",
       "      <td>3564</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>194</td>\n",
       "      <td>2020-05-10</td>\n",
       "      <td>19</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>195</td>\n",
       "      <td>2020-05-10</td>\n",
       "      <td>20</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>196</td>\n",
       "      <td>2020-05-10</td>\n",
       "      <td>21</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>197</td>\n",
       "      <td>2020-05-10</td>\n",
       "      <td>22</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>198</td>\n",
       "      <td>2020-05-10</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>199 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    first_visit_date  cohort_lifetime  user_id\n",
       "0         2020-05-04                0     5860\n",
       "1         2020-05-04                1     3021\n",
       "2         2020-05-04                2     3204\n",
       "3         2020-05-04                3     3412\n",
       "4         2020-05-04                4     3564\n",
       "..               ...              ...      ...\n",
       "194       2020-05-10               19        7\n",
       "195       2020-05-10               20        3\n",
       "196       2020-05-10               21        1\n",
       "197       2020-05-10               22        1\n",
       "198       2020-05-10               23        1\n",
       "\n",
       "[199 rows x 3 columns]"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cohorts = games_data.groupby(['first_visit_date','cohort_lifetime']).agg({'user_id':'nunique'}).reset_index() \n",
    "cohorts"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Посчитаем игроков на 0 когорту"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>first_visit_date</th>\n",
       "      <th>cohort_users</th>\n",
       "      <th>weekday</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>5860</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>32</td>\n",
       "      <td>2020-05-05</td>\n",
       "      <td>3361</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>61</td>\n",
       "      <td>2020-05-06</td>\n",
       "      <td>1847</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>92</td>\n",
       "      <td>2020-05-07</td>\n",
       "      <td>1109</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>122</td>\n",
       "      <td>2020-05-08</td>\n",
       "      <td>688</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   index first_visit_date  cohort_users  weekday\n",
       "0      0       2020-05-04          5860        0\n",
       "1     32       2020-05-05          3361        1\n",
       "2     61       2020-05-06          1847        2\n",
       "3     92       2020-05-07          1109        3\n",
       "4    122       2020-05-08           688        4"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "initial_users_cnt = cohorts[cohorts['cohort_lifetime'] == 0][['first_visit_date','user_id']]\n",
    "initial_users_cnt = initial_users_cnt.rename(columns={'user_id':'cohort_users'}).reset_index() \n",
    "initial_users_cnt['weekday'] = initial_users_cnt['first_visit_date'].dt.dayofweek\n",
    "initial_users_cnt.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Соединим таблицы и почситаем ретеншн"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>cohort_lifetime</th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>...</th>\n",
       "      <th>22</th>\n",
       "      <th>23</th>\n",
       "      <th>24</th>\n",
       "      <th>25</th>\n",
       "      <th>26</th>\n",
       "      <th>27</th>\n",
       "      <th>28</th>\n",
       "      <th>29</th>\n",
       "      <th>30</th>\n",
       "      <th>31</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>first_visit_date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.515529</td>\n",
       "      <td>0.546758</td>\n",
       "      <td>0.582253</td>\n",
       "      <td>0.608191</td>\n",
       "      <td>0.641297</td>\n",
       "      <td>0.710068</td>\n",
       "      <td>0.465529</td>\n",
       "      <td>0.427304</td>\n",
       "      <td>0.405973</td>\n",
       "      <td>...</td>\n",
       "      <td>0.007338</td>\n",
       "      <td>0.004949</td>\n",
       "      <td>0.003242</td>\n",
       "      <td>0.002048</td>\n",
       "      <td>0.001024</td>\n",
       "      <td>0.000683</td>\n",
       "      <td>0.000341</td>\n",
       "      <td>0.000171</td>\n",
       "      <td>0.000341</td>\n",
       "      <td>0.000341</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2020-05-05</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.536447</td>\n",
       "      <td>0.566201</td>\n",
       "      <td>0.612318</td>\n",
       "      <td>0.634633</td>\n",
       "      <td>0.687891</td>\n",
       "      <td>0.472776</td>\n",
       "      <td>0.451056</td>\n",
       "      <td>0.408807</td>\n",
       "      <td>0.380839</td>\n",
       "      <td>...</td>\n",
       "      <td>0.006843</td>\n",
       "      <td>0.004760</td>\n",
       "      <td>0.002678</td>\n",
       "      <td>0.002380</td>\n",
       "      <td>0.000893</td>\n",
       "      <td>0.000595</td>\n",
       "      <td>0.000298</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2020-05-06</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.519762</td>\n",
       "      <td>0.551164</td>\n",
       "      <td>0.605306</td>\n",
       "      <td>0.662696</td>\n",
       "      <td>0.434218</td>\n",
       "      <td>0.443963</td>\n",
       "      <td>0.434759</td>\n",
       "      <td>0.371413</td>\n",
       "      <td>0.332431</td>\n",
       "      <td>...</td>\n",
       "      <td>0.004873</td>\n",
       "      <td>0.005414</td>\n",
       "      <td>0.002166</td>\n",
       "      <td>0.001624</td>\n",
       "      <td>0.001624</td>\n",
       "      <td>0.002166</td>\n",
       "      <td>0.000541</td>\n",
       "      <td>0.000541</td>\n",
       "      <td>0.000541</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2020-05-07</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.507665</td>\n",
       "      <td>0.552750</td>\n",
       "      <td>0.599639</td>\n",
       "      <td>0.382326</td>\n",
       "      <td>0.400361</td>\n",
       "      <td>0.459874</td>\n",
       "      <td>0.390442</td>\n",
       "      <td>0.329125</td>\n",
       "      <td>0.291253</td>\n",
       "      <td>...</td>\n",
       "      <td>0.009919</td>\n",
       "      <td>0.006312</td>\n",
       "      <td>0.002705</td>\n",
       "      <td>0.005410</td>\n",
       "      <td>0.002705</td>\n",
       "      <td>0.002705</td>\n",
       "      <td>0.002705</td>\n",
       "      <td>0.002705</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2020-05-08</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.482558</td>\n",
       "      <td>0.545058</td>\n",
       "      <td>0.351744</td>\n",
       "      <td>0.380814</td>\n",
       "      <td>0.414244</td>\n",
       "      <td>0.440407</td>\n",
       "      <td>0.376453</td>\n",
       "      <td>0.261628</td>\n",
       "      <td>0.312500</td>\n",
       "      <td>...</td>\n",
       "      <td>0.004360</td>\n",
       "      <td>0.007267</td>\n",
       "      <td>0.001453</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.002907</td>\n",
       "      <td>0.001453</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2020-05-09</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.479545</td>\n",
       "      <td>0.320455</td>\n",
       "      <td>0.338636</td>\n",
       "      <td>0.436364</td>\n",
       "      <td>0.390909</td>\n",
       "      <td>0.420455</td>\n",
       "      <td>0.381818</td>\n",
       "      <td>0.270455</td>\n",
       "      <td>0.215909</td>\n",
       "      <td>...</td>\n",
       "      <td>0.006818</td>\n",
       "      <td>0.002273</td>\n",
       "      <td>0.002273</td>\n",
       "      <td>0.002273</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2020-05-10</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.254613</td>\n",
       "      <td>0.298893</td>\n",
       "      <td>0.328413</td>\n",
       "      <td>0.339483</td>\n",
       "      <td>0.413284</td>\n",
       "      <td>0.435424</td>\n",
       "      <td>0.369004</td>\n",
       "      <td>0.210332</td>\n",
       "      <td>0.210332</td>\n",
       "      <td>...</td>\n",
       "      <td>0.003690</td>\n",
       "      <td>0.003690</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>7 rows × 32 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "cohort_lifetime    0         1         2         3         4         5   \\\n",
       "first_visit_date                                                          \n",
       "2020-05-04        1.0  0.515529  0.546758  0.582253  0.608191  0.641297   \n",
       "2020-05-05        1.0  0.536447  0.566201  0.612318  0.634633  0.687891   \n",
       "2020-05-06        1.0  0.519762  0.551164  0.605306  0.662696  0.434218   \n",
       "2020-05-07        1.0  0.507665  0.552750  0.599639  0.382326  0.400361   \n",
       "2020-05-08        1.0  0.482558  0.545058  0.351744  0.380814  0.414244   \n",
       "2020-05-09        1.0  0.479545  0.320455  0.338636  0.436364  0.390909   \n",
       "2020-05-10        1.0  0.254613  0.298893  0.328413  0.339483  0.413284   \n",
       "\n",
       "cohort_lifetime         6         7         8         9   ...        22  \\\n",
       "first_visit_date                                          ...             \n",
       "2020-05-04        0.710068  0.465529  0.427304  0.405973  ...  0.007338   \n",
       "2020-05-05        0.472776  0.451056  0.408807  0.380839  ...  0.006843   \n",
       "2020-05-06        0.443963  0.434759  0.371413  0.332431  ...  0.004873   \n",
       "2020-05-07        0.459874  0.390442  0.329125  0.291253  ...  0.009919   \n",
       "2020-05-08        0.440407  0.376453  0.261628  0.312500  ...  0.004360   \n",
       "2020-05-09        0.420455  0.381818  0.270455  0.215909  ...  0.006818   \n",
       "2020-05-10        0.435424  0.369004  0.210332  0.210332  ...  0.003690   \n",
       "\n",
       "cohort_lifetime         23        24        25        26        27        28  \\\n",
       "first_visit_date                                                               \n",
       "2020-05-04        0.004949  0.003242  0.002048  0.001024  0.000683  0.000341   \n",
       "2020-05-05        0.004760  0.002678  0.002380  0.000893  0.000595  0.000298   \n",
       "2020-05-06        0.005414  0.002166  0.001624  0.001624  0.002166  0.000541   \n",
       "2020-05-07        0.006312  0.002705  0.005410  0.002705  0.002705  0.002705   \n",
       "2020-05-08        0.007267  0.001453       NaN  0.002907  0.001453       NaN   \n",
       "2020-05-09        0.002273  0.002273  0.002273       NaN       NaN       NaN   \n",
       "2020-05-10        0.003690       NaN       NaN       NaN       NaN       NaN   \n",
       "\n",
       "cohort_lifetime         29        30        31  \n",
       "first_visit_date                                \n",
       "2020-05-04        0.000171  0.000341  0.000341  \n",
       "2020-05-05             NaN       NaN       NaN  \n",
       "2020-05-06        0.000541  0.000541       NaN  \n",
       "2020-05-07        0.002705       NaN       NaN  \n",
       "2020-05-08             NaN       NaN       NaN  \n",
       "2020-05-09             NaN       NaN       NaN  \n",
       "2020-05-10             NaN       NaN       NaN  \n",
       "\n",
       "[7 rows x 32 columns]"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cohorts = cohorts.merge(initial_users_cnt,on='first_visit_date') \n",
    "cohorts['retention'] = cohorts['user_id']/cohorts['cohort_users']\n",
    "retention_pivot = cohorts.pivot_table(index='first_visit_date',columns='cohort_lifetime',values='retention',aggfunc='sum') \n",
    "retention_pivot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.4098659302835978"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "retention_pivot[7].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>cohort_lifetime</th>\n",
       "      <th>retention</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.470874</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0.483040</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0.488330</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0.492072</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>0.483172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>0.483281</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>0.409866</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>0.325581</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>0.307034</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   cohort_lifetime  retention\n",
       "0                0   1.000000\n",
       "1                1   0.470874\n",
       "2                2   0.483040\n",
       "3                3   0.488330\n",
       "4                4   0.492072\n",
       "5                5   0.483172\n",
       "6                6   0.483281\n",
       "7                7   0.409866\n",
       "8                8   0.325581\n",
       "9                9   0.307034"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cohorts_retention_mean = cohorts.groupby('cohort_lifetime').agg({'retention': 'mean'}).reset_index()\n",
    "cohorts_retention_mean.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Наблюдаем, что средний ретеншн за первые 7 дней сотавляет 40%  \n",
    " На первой неделе максимальный возврат приходится на пятницу - 49,2%  \n",
    "  далее показатель падает"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='3.3.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3.3. Сравним группы игроков по сценарию прохождения уровня  \n",
    " По условиям задачи первый уровень можно пройти двумя способами:  \n",
    "  1. Победить врага\n",
    "  2. Построить зданием\n",
    "\n",
    "В колонке по событиям у нас 3 вида событий: \n",
    " 1. Объект построен\n",
    " 2. Первый уровень завершен \n",
    " 3. Проект завершен\n",
    "\n",
    "Предположим и проверим, что событие \"Проект завершен\" -  \n",
    "   это и есть варинт победы над врагом -  \n",
    "   у таких игроков не будет событий \"Объект построен\".  \n",
    "    Для этого сгруппируем игроков по ивентам и убедимся что они уникальны для своих групп"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>event</th>\n",
       "      <th>user_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>building</td>\n",
       "      <td>13576</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>finished_stage_1</td>\n",
       "      <td>5817</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>project</td>\n",
       "      <td>1866</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              event  user_id\n",
       "0          building    13576\n",
       "1  finished_stage_1     5817\n",
       "2           project     1866"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "event_mean = games_data.pivot_table(index='event', values='user_id',\\\n",
    "                              aggfunc=({'user_id':'nunique'})).reset_index()\n",
    "event_mean.sort_values(by='user_id', ascending = False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "С маркировкой похоже угадали - так количество \"Проект завершен\"  \n",
    " равно количеству \"Тип реализованного проекта\".  \n",
    "  Здесь уже можно сделать вывод, что игроки строить любят - поэтому донаты на постройку  \n",
    "   за просмотр рекламы - весьма выгодный шаг."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='3.4.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3.4. Посмотрим какой тип зданий интереснее игроку"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['assembly_shop', 'spaceport', nan, 'research_center'], dtype=object)"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games_data['building_type'].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Итак, у нас есть 3 типа зданий и пустые значения  \n",
    " (у нас же есть те игроки, кто не строит ).  \n",
    "     Сгруппируем данные по количеству игроков и типам постройки."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>building_type</th>\n",
       "      <th>user_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>assembly_shop</td>\n",
       "      <td>13576</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>spaceport</td>\n",
       "      <td>13231</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>research_center</td>\n",
       "      <td>7671</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     building_type  user_id\n",
       "0    assembly_shop    13576\n",
       "2        spaceport    13231\n",
       "1  research_center     7671"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "building_mean = games_data.pivot_table(index='building_type', values='user_id',\\\n",
    "                              aggfunc=({'user_id':'nunique'})).reset_index()\n",
    "building_mean.sort_values(by='user_id', ascending = False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Видим, что сборочный цех в почете у наших игроков,  \n",
    " далле космопорт и исследовательский центр.  \n",
    "  Думаю, это связано с тем, что в сборочном цеху должно быть больше интерактива для игрока,  \n",
    "   больше элементов для взаимодецствия"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='3.5.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3.5.Сравним активность групп до и после рекламной кампании  \n",
    " У нас есть данные, что на дату 2020-05-03 была проведена рекламная компания в тестовом режиме.  \n",
    "  Сравним активность игроков. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>event</th>\n",
       "      <th>date</th>\n",
       "      <th>building</th>\n",
       "      <th>finished_stage_1</th>\n",
       "      <th>project</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>5860.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-05</td>\n",
       "      <td>6381.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-06</td>\n",
       "      <td>6853.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-07</td>\n",
       "      <td>7382.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-08</td>\n",
       "      <td>7877.0</td>\n",
       "      <td>28.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>2020-05-09</td>\n",
       "      <td>8364.0</td>\n",
       "      <td>60.0</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>2020-05-10</td>\n",
       "      <td>9158.0</td>\n",
       "      <td>151.0</td>\n",
       "      <td>34.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>2020-05-11</td>\n",
       "      <td>5836.0</td>\n",
       "      <td>233.0</td>\n",
       "      <td>76.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>2020-05-12</td>\n",
       "      <td>5600.0</td>\n",
       "      <td>313.0</td>\n",
       "      <td>96.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>2020-05-13</td>\n",
       "      <td>5377.0</td>\n",
       "      <td>389.0</td>\n",
       "      <td>175.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "event       date  building  finished_stage_1  project\n",
       "0     2020-05-04    5860.0               1.0      NaN\n",
       "1     2020-05-05    6381.0               3.0      NaN\n",
       "2     2020-05-06    6853.0               4.0      NaN\n",
       "3     2020-05-07    7382.0              11.0      NaN\n",
       "4     2020-05-08    7877.0              28.0      1.0\n",
       "5     2020-05-09    8364.0              60.0      3.0\n",
       "6     2020-05-10    9158.0             151.0     34.0\n",
       "7     2020-05-11    5836.0             233.0     76.0\n",
       "8     2020-05-12    5600.0             313.0     96.0\n",
       "9     2020-05-13    5377.0             389.0    175.0"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "avg_user_activity = games_data.pivot_table(index='date',\\\n",
    "                                           columns='event',\\\n",
    "                                           values='user_id',\\\n",
    "                                           aggfunc=({'user_id':'nunique'})).reset_index()\n",
    "avg_user_activity.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "После проведения рекламной кампании - мы видим, что идет рост числа взаимодействий в игре"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='3.6.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3.6. Сделаем выводы"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Мы озанакомились с данными по активности наших игроков и можем сделать следующие выводы:\n",
    "1. Рост продолжительности игрового времени наблюдаем к выходным дням.\n",
    "2. В нашей выборке когорты от 4 мая - это был понедельник, к выходным на той неделе подтянулись игроки  \n",
    " и на 1 неделе мы уже видим взлет ретеншена до 46%\n",
    "3. Так же мы определили, что игроки уходят спустя 1,5 - 2 недели -  \n",
    " определим дальше - возможно это связано с законченным уровнем.\n",
    "4. У нас есть два пути прохождения уровня - строить и побеждать врагов. Наши игроки любят строить -  \n",
    " пример доната в качетсве постройки за просмотр рекламы - работающая схема.  \n",
    "5. Игрокам нравится взаимодействовать с постройкой сборочного цеха - ее строят активнее всего -  \n",
    " предположу, что больше деталей и интереснее взаимодействие.\n",
    "6. Проведение рекламной кампании отразилось на поведении игроков в последствии -  \n",
    " показатель объемов активностей растет день за днем."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='4.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 4. Проверим гипотезы"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='4.1.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 4.1. Гипотеза о различии времени прохождения уровня групп игроков  \n",
    " Проверим время, за которое игроки проходят уровень при разном сценарии.  \n",
    "   Для этого выделим отдельно датасет с каждым сценарием и высчитаем время в днях.  \n",
    "    "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Сценарий 1: законичить уровень постройкой объекта"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>start</th>\n",
       "      <th>finish</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>e3c66498-9d45-4000-9392-f81e6796e7da</td>\n",
       "      <td>2020-05-04 06:50:30</td>\n",
       "      <td>2020-05-10 10:30:22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>936e7af6-8338-4703-a1df-fc6c3f5b8e34</td>\n",
       "      <td>2020-05-04 00:55:46</td>\n",
       "      <td>2020-05-17 18:32:45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>a4491c86-c498-4f74-a56e-65c136d0e9a1</td>\n",
       "      <td>2020-05-04 01:42:30</td>\n",
       "      <td>2020-05-10 14:40:04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>85d9e675-562b-4329-8bbd-14d3b39096be</td>\n",
       "      <td>2020-05-05 17:21:11</td>\n",
       "      <td>2020-05-16 11:23:27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>1889ca71-3c57-4e61-9ea6-a711971bbf0a</td>\n",
       "      <td>2020-05-04 01:27:10</td>\n",
       "      <td>2020-05-15 09:43:50</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                user_id               start  \\\n",
       "0  e3c66498-9d45-4000-9392-f81e6796e7da 2020-05-04 06:50:30   \n",
       "1  936e7af6-8338-4703-a1df-fc6c3f5b8e34 2020-05-04 00:55:46   \n",
       "2  a4491c86-c498-4f74-a56e-65c136d0e9a1 2020-05-04 01:42:30   \n",
       "3  85d9e675-562b-4329-8bbd-14d3b39096be 2020-05-05 17:21:11   \n",
       "4  1889ca71-3c57-4e61-9ea6-a711971bbf0a 2020-05-04 01:27:10   \n",
       "\n",
       "               finish  \n",
       "0 2020-05-10 10:30:22  \n",
       "1 2020-05-17 18:32:45  \n",
       "2 2020-05-10 14:40:04  \n",
       "3 2020-05-16 11:23:27  \n",
       "4 2020-05-15 09:43:50  "
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Вспомним мирных игроков \n",
    "builders = games_data.query('event == \"project\"')['user_id'].drop_duplicates().reset_index()\n",
    "builders.name = 'builders'\n",
    "\n",
    "#Первая дата для мирных\n",
    "first_date_user_bld = games_data.groupby('user_id')['event_datetime'].min().reset_index()\n",
    "first_date_user_bld.name = 'first_date_user_bld'\n",
    "\n",
    "#Соединим по id мирных и первые даты\n",
    "bld_user_date_first = builders.merge(first_date_user_bld, on='user_id', how='left')\n",
    "bld_user_date_first.name = 'bld_user_date_first'\n",
    "\n",
    "#Финальная дата для мирных\n",
    "finish_date_user_bld = games_data.groupby('user_id')['event_datetime'].max().reset_index()\n",
    "finish_date_user_bld.name = 'finish_date_user_bld'\n",
    "\n",
    "#Соединим по id мирных и первые даты\n",
    "bld_user_date_finish = bld_user_date_first.merge(finish_date_user_bld, on='user_id', how='left')\n",
    "bld_user_date_finish.name = 'bld_user_date_finish'\n",
    "#bld_user_date_finish.head()\n",
    "del(bld_user_date_finish['index'])\n",
    "\n",
    "bld_user_date_finish.columns = ['user_id','start', 'finish']\n",
    "bld_user_date_finish.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "13.0"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bld_user_date_finish['delta'] = (bld_user_date_finish['finish'] - bld_user_date_finish['start']).dt.days\n",
    "bld_way_time_duration = bld_user_date_finish['delta'].sum() / bld_user_date_finish['user_id'].nunique()\n",
    "bld_way_time_duration.round()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Выбирая первый путь реализации проекта игрок тратит 13 дней"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Сценарий 2: закончить уровень победой над врагом"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>start</th>\n",
       "      <th>finish</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>6edd42cc-e753-4ff6-a947-2107cd560710</td>\n",
       "      <td>2020-05-04 00:00:16</td>\n",
       "      <td>2020-05-16 11:51:58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>cdc6bb92-0ccb-4490-9866-ef142f09139d</td>\n",
       "      <td>2020-05-04 00:00:35</td>\n",
       "      <td>2020-05-11 14:18:05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>4fe0f101-694b-4e31-9740-d1d87f7208ea</td>\n",
       "      <td>2020-05-04 00:00:36</td>\n",
       "      <td>2020-05-16 13:08:11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>9c200ece-3b74-44c4-8a3f-260f2486c5d7</td>\n",
       "      <td>2020-05-04 00:02:24</td>\n",
       "      <td>2020-05-12 18:19:19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>02bf92c2-17a0-4156-be88-2054fb6b7421</td>\n",
       "      <td>2020-05-04 00:03:10</td>\n",
       "      <td>2020-05-11 21:12:29</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                user_id               start  \\\n",
       "0  6edd42cc-e753-4ff6-a947-2107cd560710 2020-05-04 00:00:16   \n",
       "1  cdc6bb92-0ccb-4490-9866-ef142f09139d 2020-05-04 00:00:35   \n",
       "2  4fe0f101-694b-4e31-9740-d1d87f7208ea 2020-05-04 00:00:36   \n",
       "3  9c200ece-3b74-44c4-8a3f-260f2486c5d7 2020-05-04 00:02:24   \n",
       "4  02bf92c2-17a0-4156-be88-2054fb6b7421 2020-05-04 00:03:10   \n",
       "\n",
       "               finish  \n",
       "0 2020-05-16 11:51:58  \n",
       "1 2020-05-11 14:18:05  \n",
       "2 2020-05-16 13:08:11  \n",
       "3 2020-05-12 18:19:19  \n",
       "4 2020-05-11 21:12:29  "
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Вспомним воинов, что они не строители и тоже победители\n",
    "builders_1 = games_data.query('event == \"project\"')['user_id'].drop_duplicates()\n",
    "warriors = games_data.query('user_id in @winners and user_id not in @builders_1')['user_id'].drop_duplicates().reset_index()\n",
    "warriors.name = 'warriors'\n",
    "#warriors.info()\n",
    "\n",
    "#Первая дата для воинов\n",
    "first_date_user_war = games_data.merge(warriors, on='user_id', how='left')\n",
    "first_date_user_war = first_date_user_war.groupby('user_id')['event_datetime'].min().reset_index()\n",
    "first_date_user_war.name = 'first_date_user_war'\n",
    "\n",
    "#Соединим по id воинов и первые даты\n",
    "war_user_date_first = warriors.merge(first_date_user_war, on='user_id', how='left')\n",
    "war_user_date_first.name = 'war_user_date_first'\n",
    "\n",
    "#Финальная дата для воинов\n",
    "finish_date_user_war = games_data.groupby('user_id')['event_datetime'].max().reset_index()\n",
    "finish_date_user_war.name = 'finish_date_user_war'\n",
    "\n",
    "#Соединим по id воинов и первые даты\n",
    "war_user_date_finish = war_user_date_first.merge(finish_date_user_war, on='user_id', how='left')\n",
    "war_user_date_finish.name = 'war_user_date_finish'\n",
    "#war_user_date_finish.head()\n",
    "del(war_user_date_finish['index'])\n",
    "\n",
    "war_user_date_finish.columns = ['user_id','start', 'finish']\n",
    "war_user_date_finish.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "11.0"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "war_user_date_finish['delta'] = (war_user_date_finish['finish'] - war_user_date_finish['start']).dt.days\n",
    "war_way_time_duration = war_user_date_finish['delta'].sum() / war_user_date_finish['user_id'].nunique()\n",
    "war_way_time_duration.round()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Чтобы победить врага игрок тратит 11 дней"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Определим едентичны ли группы по времени прохождения уровня.  \n",
    " Введем понимание -\n",
    " 1. Тестируемы группы - группа по сценарию 1 и группа по сценарию 2\n",
    " 2. Зададим критический уровень значимости .05\n",
    " 3. Нулевая гипотеза - тестируемые группы не имеют значимых различий\n",
    " 4. Альтернативная гипотеза - тестируемые группы имеют значимые различия"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [],
   "source": [
    "bld_way_time_duration = bld_user_date_finish['delta']\n",
    "war_way_time_duration = war_user_date_finish['delta']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Оценим дисперсию по выборкам"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "12.431108549332617"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.var(bld_way_time_duration)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "16.855785703390964"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.var(war_way_time_duration)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Поcмотрим стандартное отклонение по выборкам"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3.5257777226212967"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.sqrt(np.var(bld_user_date_finish['delta']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4.105579825480314"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.sqrt(np.var(war_user_date_finish['delta']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Ttest_indResult(statistic=22.540649778031987, pvalue=2.6237027268064204e-106)"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "st.ttest_ind(bld_way_time_duration, war_way_time_duration, equal_var=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "p-значение: 1.8882835392369192e-97\n",
      "Отвергаем нулевую гипотезу\n"
     ]
    }
   ],
   "source": [
    "alpha = 0.05\n",
    "\n",
    "results = st.ttest_ind(\n",
    "    bld_way_time_duration,\n",
    "    war_way_time_duration,\n",
    "    nan_policy ='omit')\n",
    "print('p-значение:', results.pvalue)\n",
    "\n",
    "if (results.pvalue < alpha):\n",
    "    print(\"Отвергаем нулевую гипотезу\")\n",
    "else:\n",
    "    print(\"Не получилось отвергнуть нулевую гипотезу\") "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Вывод:  \n",
    " между группами игроков проходящими уровень разными сценариями есть статистически значимые различия,  \n",
    "  на время затраченное на прохождение уровня.  \n",
    "   Путь строительства для игрока занимает в среднем на 2 дня больше, чем путь воина,  \n",
    "    соответсвенно и рекламы он может увидеть больше."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='5.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 5. Проверим маркетинговые метрики"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='5.1.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 5.1. Оценим конверсию по рекламным объявлениям"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Для начала вспомним наш датасет "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>day</th>\n",
       "      <th>cost</th>\n",
       "      <th>user_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>0001f83c-c6ac-4621-b7f0-8a28b283ac30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>002f508f-67b6-479f-814b-b05f00d4e995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>004074f8-251a-4776-922c-8348dca1a2f6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>00440efd-aa50-4b4b-aae8-ffcd1782729d</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>935.882786</td>\n",
       "      <td>00965328-5e54-453f-b11b-52f8ae9ae80b</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         source        day        cost                               user_id\n",
       "0  facebook_ads 2020-05-03  935.882786  0001f83c-c6ac-4621-b7f0-8a28b283ac30\n",
       "1  facebook_ads 2020-05-03  935.882786  002f508f-67b6-479f-814b-b05f00d4e995\n",
       "2  facebook_ads 2020-05-03  935.882786  004074f8-251a-4776-922c-8348dca1a2f6\n",
       "3  facebook_ads 2020-05-03  935.882786  00440efd-aa50-4b4b-aae8-ffcd1782729d\n",
       "4  facebook_ads 2020-05-03  935.882786  00965328-5e54-453f-b11b-52f8ae9ae80b"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adv_all_data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Посмотри названия источников"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['facebook_ads', 'instagram_new_adverts', 'yandex_direct',\n",
       "       'youtube_channel_reklama'], dtype=object)"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adv_all_data['source'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "7603.58"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_cost = adv_all_data['cost'].unique().sum()\n",
    "total_cost.round(2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Итоговые косты равны 7603,58"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Оценим конверсию как количество игроков пришедших с каждого источника "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>user_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>yandex_direct</td>\n",
       "      <td>4817</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "      <td>3347</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2726</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>youtube_channel_reklama</td>\n",
       "      <td>2686</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    source  user_id\n",
       "2            yandex_direct     4817\n",
       "1    instagram_new_adverts     3347\n",
       "0             facebook_ads     2726\n",
       "3  youtube_channel_reklama     2686"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adv_user = adv_all_data.pivot_table(index='source',\\\n",
    "                                    values = 'user_id',\\\n",
    "                                    aggfunc = {'user_id':'nunique'}).reset_index()\n",
    "adv_user.sort_values(by='user_id', ascending = False).head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1152x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(16,4))\n",
    "sns.barplot(x='source', y='user_id', data=adv_user)\n",
    "plt.title(\"Соотношение количества игроков по источникам трафика\")\n",
    "plt.xticks(rotation=45)\n",
    "plt.xlabel(\"Источник трафика\")\n",
    "plt.ylabel(\"Количествo пришедших игроков\")\n",
    "plt.show;"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Видим, что самый популярный у нас источник трафика - это реклама на Яндексе,  \n",
    " самый не популярный ютьюб. Добавим данные в долях исходя их количества игроков"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "13576"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cnt_first_visit_date_u = games_data['user_id'].nunique()\n",
    "cnt_first_visit_date_u"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>user_id</th>\n",
       "      <th>share_user</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>yandex_direct</td>\n",
       "      <td>4817</td>\n",
       "      <td>0.35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "      <td>3347</td>\n",
       "      <td>0.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2726</td>\n",
       "      <td>0.20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>youtube_channel_reklama</td>\n",
       "      <td>2686</td>\n",
       "      <td>0.20</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    source  user_id  share_user\n",
       "2            yandex_direct     4817        0.35\n",
       "1    instagram_new_adverts     3347        0.25\n",
       "0             facebook_ads     2726        0.20\n",
       "3  youtube_channel_reklama     2686        0.20"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adv_user['share_user'] = adv_user['user_id']/cnt_first_visit_date_u\n",
    "adv_user.sort_values(by='user_id', ascending = False).round(2).head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Яндекс дает нам прирост аудитории в 35%, что весьма уверенно."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "source              0\n",
       "day                 0\n",
       "cost                0\n",
       "event_datetime      0\n",
       "event               0\n",
       "building_type       0\n",
       "user_id             0\n",
       "project_type        0\n",
       "date                0\n",
       "first_visit         0\n",
       "visit_date          0\n",
       "first_visit_date    0\n",
       "cohort_lifetime     0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "yandex_user = adv_all_data.query('source == \"yandex\"')\n",
    "bld_user = games_data.query('event == \"building\"')\n",
    "user_data = yandex_user.merge(bld_user, on='user_id', how='left')\n",
    "#user_data['event'].unique()\n",
    "user_data.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Пропусков нет - следовательно, все пришедшие игроки с Яндекса, потенциально могут смотреть рекламу в игре."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='5.2.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 5.2. Оценим затраты на источники трафика"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>day</th>\n",
       "      <th>source</th>\n",
       "      <th>cost</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>935.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "      <td>943.20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>yandex_direct</td>\n",
       "      <td>969.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>youtube_channel_reklama</td>\n",
       "      <td>454.22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>548.35</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         day                   source    cost\n",
       "0 2020-05-03             facebook_ads  935.88\n",
       "1 2020-05-03    instagram_new_adverts  943.20\n",
       "2 2020-05-03            yandex_direct  969.14\n",
       "3 2020-05-03  youtube_channel_reklama  454.22\n",
       "4 2020-05-04             facebook_ads  548.35"
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#adv_all_data['day_cost'] = \n",
    "#day_cost = adv_all_data.groupby('source')['cost'].sum().reset_index()\n",
    "day_cost = adv_all_data.pivot_table(index=['day','source'], values='cost', aggfunc={'mean'}).reset_index()\n",
    "day_cost = day_cost.rename(columns={'mean':'cost'})\n",
    "day_cost.round(2).head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>day</th>\n",
       "      <th>cost</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>3302.45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>1865.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-05</td>\n",
       "      <td>1029.43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-06</td>\n",
       "      <td>620.48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-07</td>\n",
       "      <td>391.85</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         day     cost\n",
       "0 2020-05-03  3302.45\n",
       "1 2020-05-04  1865.00\n",
       "2 2020-05-05  1029.43\n",
       "3 2020-05-06   620.48\n",
       "4 2020-05-07   391.85"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "day_cost_sum = day_cost.groupby('day')['cost'].sum().reset_index()\n",
    "day_cost_sum.round(2).head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Видим, что максимальные траты у нас приходятся на 3 мая.  \n",
    " Посмотрим нагляднее."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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deuydu3aPe5n1apVPP3001x99dXlUFX5cAmSJEmSJEk7sDvhC6QCmEWLFpVLDYWFheXSz/6gsLCQVatW8Yc//KGiS9mGAYwkSZIkSTtQt25dAKZOnUr37t254IILOO6447jsssuIMQJwyy23cPzxx5OVlcWNN97I22+/zUsvvcTQoUNp06YNH330EY888gjt27endevWnH/++axfvx6Ajz76iE6dOpGZmcmwYcO2uV/Xrl05++yzi2bR9OnThxNOOIFWrVrx8MMPb1Pj0KFDadWqFaeddhozZ86ke/fufO973+Oll14qdWxjx47lvPPOo2fPnhx77LHcdNNNRecmTZpE586dadeuHRdeeCFr164lNzeX8847D4CJEydSu3ZtNm3axMaNG/ne975X6n1KG/snn3xC586di8a+1cUXX8wrr7xS9L5///5MmDCBzZs3M3ToUNq3b09WVhYPPfRQic/qlltu4aOPPqJNmzYMHTqU5cuX061bN9q0aUNGRgbTp0/f2Y+93LkEaTtPvPt1hd27ytEVdmtJkiRJUhnMnTuX9957jyOOOIIuXbowY8YMWrZsyQsvvMD7779PCIFVq1ZRv359zj77bHr37s0FF1wAQP369Rk8eDAAw4YN49FHH+W6665jyJAhDBkyhEsuuYQHH3xwm/vNmTOHhQsX0qxZMwAee+wxDjnkEDZs2ED79u05//zzadCgAevWreOUU07ht7/9Leeeey7Dhg3jjTfeYNGiRfTr14+zzz671DHl5eUxd+5catasSYsWLbjuuuuoXbs2I0aMYPLkydSpU4e77rqLe+65h5///Ofk5eUBMH36dDIyMsjNzaWwsJCOHTuWeo/zzjuv1LFfddVVXH755TzwwANF7S+66CL++7//m7POOotNmzbx5ptvMmbMGB599FHq1atHbm4u33zzDV26dOGMM8741rPKz89n4cKFRbX+7ne/Iycnh1tvvZXNmzcXBUB7kwGMJEmSJEll1KFDB5o0aQJAmzZtyM/Pp1OnTtSqVYuf/OQn9O7dm969e5d47cKFCxk2bBirVq1i7dq15OTkAPDOO+/w4osvAnDppZdy4403bnO/reELwH333ccLL7wAwGeffcbSpUtp0KABNWrUoGfPngBkZmZSs2ZNqlevTmZmJvn5+Tsc06mnnkq9evUAOP744/n0009ZtWoVixYtokuXLgBs2rSJzp07U61aNb7//e+zePFiZs6cyQ033MC0adPYvHkzXbt2LfUepY19xowZPP/88wD07duXm2++GYBevXoxZMgQvvnmG1577TW6detG7dq1mTRpEvPnz2fChAkArF69mqVLl1KjRo1vPavi2rdvz8CBAykoKKBPnz60adNmh88kCS5BkiRJkiSpjGrWrFn0umrVqhQWFlKtWjVmzpzJBRdcwMsvv1wUhGyvf//+3H///SxYsIDbb7+djRs37vR+derUKXo9depUJk+ezDvvvMO8efNo27ZtUR/Vq1cnhABAlSpViuqsUqXKTvePKWlMMUZOP/108vLyyMvLY9GiRTz66KMAdOvWjb/+9a9Ur16d0047jbfeeou33nprhwHMjsa+te7iatWqRffu3Xn99dcZP348F110EQAxRkaPHl1U1yeffFI0A6b4s9pet27dmDZtGkceeST9+/dn3LhxO3wmSTCAkSRJkiRpD6xdu5bVq1dz5pln8vvf/5558+YBcOCBB7JmzZqidmvWrKFx48YUFBTw1FNPFR3v1KlT0SyQZ599ttT7rF69moMPPpgDDjiA999/n3fffTehEaVqmjFjBh9++CEA69atY8mSJQB07dqVUaNG0blzZxo2bMiXX37JBx98QEZGRqn9lTb2Ll26FI25+HFILUN6/PHHmT59elGolZOTw5gxYygoKABgyZIlrFu37lv32/7Zf/rppzRq1IjBgwczaNAg5syZszuPZY+4BEmSJEmStM8oy9dG721r1qzhnHPOYePGjcQYueeee4DURrKDBw/mvvvuY8KECfzyl7+kY8eONGzYkI4dOxYFBKNGjeLHP/4xv/rVr+jZs2fRcqDt9ezZkwcffJCWLVvSokULOnXqlNiYGjZsyNixY7nkkkv45ptvABgxYgTNmzenY8eOrFixgm7dugGQlZXFF198UeJMlq1KG/u9997LpZdeyl133cU552z7sz3jjDPo27cv55xzDjVq1ABg0KBB5Ofn065dO2KMNGzYsGj5VnENGjSgS5cuZGRk0KtXLzIyMvjtb39L9erVqVu3boXMgAlbd2yuTLKzs+OsWbN269qK3YR3SoXct8+MDRVy3wMvvLhC7itJkiRp37F48WJatmxZ0WUkav369dSuXZsQAs8++yzPPPMMEydOrOiyVAYlfT5DCLNjjNnb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etCjRw8A6tatW9RuwoQJ9O/fv+j95MmTyc7Opnnz5kUzPTZv3szQoUNp3749WVlZPPTQQzus+6677iIzM5PWrVtzyy23FB1/7rnn6NChA82bN2f69OkA5Ofn07VrV9q1a0e7du14++23i8bTvXt3LrjgAo477jguu+wyYowANG3alNtvv5127dqRmZnJ+++/D8C6desYOHAgHTp0oG3btkycOLFMz3n48OH07duXLl260Ldv3zKNNzc3l7Zt2/LRRx9tc/wvf/kLHTt2pG3btpx22mmsWLGi6B79+vWja9euHHPMMfz5z3/mpptuIjMzk549e1JQUADAnXfeSfv27cnIyOCKK64oGvOeMoCRJEmSJKkUAwcOZNy4cQBs2bKFZ599liZNmpCXl8e8efOYPHkyQ4cOZfny5aX2cf3113PEEUcwZcoUpkyZstN75ufnM3PmTF555RWuvPJKNm7cyKOPPkq9evXIzc0lNzeXRx55hE8++aTE6//6178yceJE/va3vzFv3jxuuummonOFhYXMnDmTUaNGcccddwBw2GGH8cYbbzBnzhzGjx/P9ddfX9R+7ty5jBo1ikWLFvHxxx8zY8aMonOHHnooc+bM4aqrrmLkyJEA/OpXv+KUU05h5syZTJkyhaFDh7Ju3bqdjhlg0aJFTJ48mWeeeWan43377be58sormThxIt///ve36eekk07i3XffZe7cuVx88cXcfffdRec++ugj/ud//oeXXnqJH//4x/To0YMFCxZQu3ZtXnnlFSAVnOXm5rJw4UI2bNiwx8umtnIPGEmSJEmSStG0aVMaNGjA3LlzWbFiBW3btuWtt97ikksuoWrVqjRq1IiTTz6Z3NxcDjrooHK5549+9COqVKnCsccey/e+9z3ef/99Jk2axPz585kwYQIAq1evZunSpTRr1uxb10+ePJkBAwYU7TdzyCGHFJ0777zzADjhhBPIz88HoKCggGuvvZa8vDyqVq3KkiVLitp36NCBJk2aANCmTRvy8/M56aSTvtXXn//8ZwAmTZrESy+9VBTIbNy4kb///e9lGvfZZ59N7dq1i/opabw1atRg8eLFXHHFFUyaNIkjjjjiW/0sW7aMiy66iOXLl7Np06ZtnlGvXr2oXr06mZmZbN68mZ49ewKQmZlZ9DymTJnC3Xffzfr16/nqq69o1aoVP/zhD8s0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\n",
      "text/plain": [
       "<Figure size 1368x720 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(19,10))\n",
    "day_cost['day'] = day_cost['day'].dt.date\n",
    "sns.barplot(x='day', y='cost', hue='source', data=day_cost)\n",
    "plt.title(\"Затраты на рекламу по дням и источникам\")\n",
    "plt.xlabel(\"Дата\")\n",
    "plt.ylabel(\"Затраты\")\n",
    "plt.show;"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>cost</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>yandex_direct</td>\n",
       "      <td>2233.11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "      <td>2161.44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2140.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>youtube_channel_reklama</td>\n",
       "      <td>1068.12</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    source     cost\n",
       "2            yandex_direct  2233.11\n",
       "1    instagram_new_adverts  2161.44\n",
       "0             facebook_ads  2140.90\n",
       "3  youtube_channel_reklama  1068.12"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source_cost_sum = day_cost.groupby('source')['cost'].sum().reset_index()\n",
    "source_cost_sum.sort_values(by='cost', ascending = False).round(2).head()                                 "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Посмотрим долю от общих затрат каждого источника трафика "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>cost</th>\n",
       "      <th>share_cost</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>yandex_direct</td>\n",
       "      <td>2233.11</td>\n",
       "      <td>0.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "      <td>2161.44</td>\n",
       "      <td>0.28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2140.90</td>\n",
       "      <td>0.28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>youtube_channel_reklama</td>\n",
       "      <td>1068.12</td>\n",
       "      <td>0.14</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    source     cost  share_cost\n",
       "2            yandex_direct  2233.11        0.29\n",
       "1    instagram_new_adverts  2161.44        0.28\n",
       "0             facebook_ads  2140.90        0.28\n",
       "3  youtube_channel_reklama  1068.12        0.14"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source_cost_sum['share_cost'] = source_cost_sum['cost']/total_cost\n",
    "source_cost_sum.sort_values(by='cost', ascending = False).round(2).head() "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Самый активно приносящий лидов источник забирает себе 29% от наших расходов"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>cost</th>\n",
       "      <th>share_cost</th>\n",
       "      <th>lead_cost</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>yandex_direct</td>\n",
       "      <td>2233.11</td>\n",
       "      <td>0.29</td>\n",
       "      <td>0.16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "      <td>2161.44</td>\n",
       "      <td>0.28</td>\n",
       "      <td>0.16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>2140.90</td>\n",
       "      <td>0.28</td>\n",
       "      <td>0.16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>youtube_channel_reklama</td>\n",
       "      <td>1068.12</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.08</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    source     cost  share_cost  lead_cost\n",
       "2            yandex_direct  2233.11        0.29       0.16\n",
       "1    instagram_new_adverts  2161.44        0.28       0.16\n",
       "0             facebook_ads  2140.90        0.28       0.16\n",
       "3  youtube_channel_reklama  1068.12        0.14       0.08"
      ]
     },
     "execution_count": 67,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source_cost_sum['lead_cost'] = source_cost_sum['cost']/cnt_first_visit_date_u\n",
    "source_cost_sum.sort_values(by='cost', ascending = False).round(2).head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Получается, что лиды в цене на трех источниках и не отличаются."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='5.3.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 5.3. Построим маркетинговую воронку по дням"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "У нас есть затраты по источникам на каждый день"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>day</th>\n",
       "      <th>source</th>\n",
       "      <th>cost</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>935.882786</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>instagram_new_adverts</td>\n",
       "      <td>943.204717</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>yandex_direct</td>\n",
       "      <td>969.139394</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>youtube_channel_reklama</td>\n",
       "      <td>454.224943</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>facebook_ads</td>\n",
       "      <td>548.354480</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          day                   source        cost\n",
       "0  2020-05-03             facebook_ads  935.882786\n",
       "1  2020-05-03    instagram_new_adverts  943.204717\n",
       "2  2020-05-03            yandex_direct  969.139394\n",
       "3  2020-05-03  youtube_channel_reklama  454.224943\n",
       "4  2020-05-04             facebook_ads  548.354480"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "day_cost.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Есть суммарные затраты на день.  \n",
    " Посмотрим по ним график"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>day</th>\n",
       "      <th>cost</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2020-05-03</td>\n",
       "      <td>3302.451840</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2020-05-04</td>\n",
       "      <td>1865.004649</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2020-05-05</td>\n",
       "      <td>1029.431469</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2020-05-06</td>\n",
       "      <td>620.476519</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2020-05-07</td>\n",
       "      <td>391.852033</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         day         cost\n",
       "0 2020-05-03  3302.451840\n",
       "1 2020-05-04  1865.004649\n",
       "2 2020-05-05  1029.431469\n",
       "3 2020-05-06   620.476519\n",
       "4 2020-05-07   391.852033"
      ]
     },
     "execution_count": 69,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "day_cost_sum.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Посмотрим эти данные на графике"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAABGAAAAJdCAYAAAB9OgHgAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAgAElEQVR4nOzdf/zmdV3n++dLxh8lKiAjIqBQ4Ra2ioqIbe5mnhXUOthuuZgpmh66GWxa9gOrVY/GOWWau56KwkQxUbK05CitzXpS8xTK4KIGZEwmCyPCKCK4/gp47R/XZ/Jy/H6H78x83/Od7zX3++32vX2v6/35cb2vaz5zc3zw+Xyu6u4AAAAAMM7d1noCAAAAAItOgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAGAfVhVHVRVf1FVN1bVF6vq01X1mqr6trWeGwAAKyfAAMC+7etJXpHkyO6+X5LHJHlkkl9d01kBALBLBBgA2Id195e7+0Pd/U/bh5LcmeRzSVJVB1fVu6tqW1V9YXp85LTsF6vqS9PPnVX1lenxldPyN1XV71XVpqq6rao+UFUP2f7aVfVfquq6qrq1qi6vqsdP44+b2+8/VdXX554/uKqeU1Uf2vG9VNV3VVUv916ns3v+t7nnz6+q99/VfJbZ1129t++elt1cVZ+sqqfvsO2vTY/vX1VXVdUL5pYfXVU9957vqKrnT8tOrKq/qapbquqGqvrtqrrH3LZdVR+be35AVW2tquun579QVe/Y4b28rqr+y04+s6/MzeWrO3xm31dVl01nT11WVd+33Gc2rf+WuT/Pr2yf146fy/T8m/48q+p7qur/n/58tn8uz5mWvXx67z8yt/5PT2PP39mcAGBRCDAAsA5U1YVV9aUk25Js6+7XTovuluSNSR6S5MFJvpLkt5Oku1/V3Qd294FJ/keSH56eP2xu189M8sokhya5IsmFc8suS3J8kkOSvDXJH1fVvbr7b+b2e2GSf36d7v4fYz6B5eezk/WXfG9Vde8km6Z9PCDJaUl+t6qOm9+4qg5M8udJ3trd584t2v7vp/tNn8FfzS27I8nPTq/5uCRPTPLTO8zrHlX1mOnxU5N8cW7ZW5KcUlUHTXPYMM3vzTt5nz889+dx1tz8D0nyniSvS3L/JL+V5D1Vdf+d7KuSnDPt68k7WW8pL0tydZJDpu3/Zoflf5dkPrY8J8k1u/gaALBuCTAAsA509zOT3CfJ9yT5nqr6uWn88939julMmduSnJPk3+zCrt/T3R/s7q8l+ZUkj6uqo6Z9v2Xa/+3d/Zok90zyL1bzfe2K3ZjPcu/th5J8urvfOO3rvyd5R5Ifm9v2nkn+LMnV3f1rO+z3Hknu7O47lpjj5d196bTfTyf5/Xzrn8cb8o0Q8fzp+fbtb0jywbm5nJLkc919+U7e53KemuSa7v7DaT5vyyyC/PBOtvm2zC57210HZPl/X16e5IFVdWRVPSrJjUk+swevBQDrigADAOtEz/xdkl9P8uwkqapvr6rfr6prq+rWzP7P+0FVdcAKd3vd3P6/lOTmJA+a9v3zVXX1dPnKLUnul9mZHStx0nQZzs1V9ddVdcIKt/uzabtbMjtz45/txnyWe28PSfLY7a8z7euZSR44t+2ZSe6d5PvqW294fEiSLyz1glX10JpdBvbZ6c/j/1piju9O8gNV9V1JDs8sTMy7IMlPTI9/Iskf7uQ97syDkly7w9i1SY7YyTYPzOwsq+X8/Nxn9tEdlv1Kku9I8uVp+UlLbP/GJM/NLDz9wU5eBwAWjgADAOvPAZndByZJXpzZWSCP7e77JvnX03itcF9HbX8wXXJzSJLPTPdX+cUkT09ycHcflNmlMivd76XTNhszu9znt1e43dO6+6Bp25+Zm9vuzGfJ95ZZmPnA9teZfg7s7hfMbfvXSR6f2WVP5+yw34cm+ftlXvPczM4yOXb68/jlJeZ4e5I/TfInSd60xD7+LMnDq+p7Mztb58Il1lmJz2QWm+Y9OMnWpVauqrsn+d4kH1tq+eTVc38+j5pf0N3/MG37+9PyS5fY/i1JfjzJEzK7PAoA9hsCDADsw6rquOnGrPefnn9Pkl/K7P4lyeyypK8kuWW658fLdvElnlJV3z/dKPaVmYWT66b93p7Z2RAbquqlSe67q/OfLtP5Yvb83xy7M5/l3tu7kzy0qp5VVXeffh4zfbbbXdrdt2cWgZ5RVY9LkukSphdmFkmWm+etSb5UVd+d5AXLrHdeZvdL+Za40t1fzSzOvDXJR/bgvjqXZPY+f7yqNlTVf0hyXGbvfynPTfLZJJt358Wq6qQkT0vykuXW6e5bMjsL5jXT5wsA+w0BBgD2bbdkdg+RK6ZLWv44ye9096un5f85s/t2fC6zMw7+6y7u/62ZRZubkzw637j05b3Tvv4+s8tWvpq5S3pW4DFVdf30LTrPzCxa7Indmc+S7226V86TMru57Wcyiw6/kdl9X75Jd38uyX9Mcn5V3XOax/uTvHbHdSc/n9kZHrcleX2SP1pqpe7+VHc/YwoSS7kgyb/M7l9+lO7+fGZn0Lw4yeczO4Poh6b39E2q6pmZ3a/mmCS3TTd8/vMkD6qq37ur15rOnnl9khd29613Ma9XdbfLjwDY71T3st8GCQAssKp6U5Lru/tX13ouq229v7eqenBmlzI98K6Cxiq93nOSHN3dL99h/Mgkv9bdzxk9BwBYdM6AAQDYh1TV3ZL8XJKL9kZ8mfzPzC6d2tHtmZ1BBADsoQ1rPQEAAGaq6t6ZfT3ztZl9BfVe0d1/vMz4ZzOLQQDAHnIJEgAAAMBgLkECAAAAGEyAAQAAABhsIe8Bc+ihh/bRRx+91tMAAAAA9jOXX37557p7447jCxlgjj766GzevHmtpwEAAADsZ6rq2qXGXYIEAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADCYAAMAAAAw2Ia1nsC+aNu5b1nrKTDYxhf8xFpPAQAAgP2IM2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhsWYKrqXlX1kar6WFVdWVX/5zR+TFV9uKq2VNUfVdU9pvF7Ts+3TMuPntvXS6bxT1bVyaPmDAAAADDCyDNgvpbkB7v7EUmOT3JKVZ2U5DeSvLa7vyvJF5I8b1r/eUm+MI2/dlovVXVcktOSPCzJKUl+t6oOGDhvAAAAgFU1LMD0zJemp3effjrJDyb5k2n8giRPmx6fOj3PtPyJVVXT+EXd/bXu/sckW5KcOGreAAAAAKtt6D1gquqAqroiyU1JNiX5hyS3dPft0yrXJzlienxEkuuSZFr+xST3nx9fYpv51zqjqjZX1eZt27aNeDsAAAAAu2VogOnuO7r7+CRHZnbWyncPfK3zuvuE7j5h48aNo14GAAAAYJftlW9B6u5bkvxlksclOaiqNkyLjkyydXq8NclRSTItv1+Sz8+PL7ENAAAAwD5v5Lcgbayqg6bH35bk3ya5OrMQ86PTaqcnedf0+OLpeabl/1939zR+2vQtScckOTbJR0bNGwAAAGC1bbjrVXbb4UkumL6x6G5J3t7d766qq5JcVFW/luS/J3nDtP4bkvxhVW1JcnNm33yU7r6yqt6e5Koktyc5s7vvGDhvAAAAgFU1LMB098eTPHKJ8U9liW8x6u6vJvmxZfZ1TpJzVnuOAAAAAHvDXrkHDAAAAMD+TIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhMgAEAAAAYTIABAAAAGEyAAQAAABhsWICpqqOq6i+r6qqqurKqXjiNv7yqtlbVFdPPU+a2eUlVbamqT1bVyXPjp0xjW6rq7FFzBgAAABhhw8B9357kxd390aq6T5LLq2rTtOy13f3q+ZWr6rgkpyV5WJIHJflvVfXQafHvJPm3Sa5PcllVXdzdVw2cOwAAAMCqGRZguvuGJDdMj2+rqquTHLGTTU5NclF3fy3JP1bVliQnTsu2dPenkqSqLprWFWAAAACAdWGv3AOmqo5O8sgkH56Gzqqqj1fV+VV18DR2RJLr5ja7fhpbbhwAAABgXRgeYKrqwCTvSPKi7r41yblJvjPJ8ZmdIfOaVXqdM6pqc1Vt3rZt22rsEgAAAGBVDA0wVXX3zOLLhd39ziTp7hu7+47uvjPJ6/ONy4y2JjlqbvMjp7Hlxr9Jd5/X3Sd09wkbN25c/TcDAAAAsJtGfgtSJXlDkqu7+7fmxg+fW+1Hkvzt9PjiJKdV1T2r6pgkxyb5SJLLkhxbVcdU1T0yu1HvxaPmDQAAALDaRn4L0r9K8qwkn6iqK6axX07yjKo6Pkkn+XSSn0qS7r6yqt6e2c11b09yZnffkSRVdVaS9yY5IMn53X3lwHkDAAAArKqR34L0oSS1xKJLdrLNOUnOWWL8kp1tBwAAALAv2yvfggQAAACwPxNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGGxZgquqoqvrLqrqqqq6sqhdO44dU1aaqumb6ffA0XlX1uqraUlUfr6pHze3r9Gn9a6rq9FFzBgAAABhh5Bkwtyd5cXcfl+SkJGdW1XFJzk7yvu4+Nsn7pudJ8uQkx04/ZyQ5N5kFmyQvS/LYJCcmedn2aAMAAACwHgwLMN19Q3d/dHp8W5KrkxyR5NQkF0yrXZDkadPjU5O8uWcuTXJQVR2e5OQkm7r75u7+QpJNSU4ZNW8AAACA1bZX7gFTVUcneWSSDyc5rLtvmBZ9Nslh0+Mjklw3t9n109hy4wAAAADrwvAAU1UHJnlHkhd1963zy7q7k/Qqvc4ZVbW5qjZv27ZtNXYJAAAAsCqGBpiquntm8eXC7n7nNHzjdGlRpt83TeNbkxw1t/mR09hy49+ku8/r7hO6+4SNGzeu7hsBAAAA2AMjvwWpkrwhydXd/Vtziy5Osv2bjE5P8q658WdP34Z0UpIvTpcqvTfJk6rq4Onmu0+axgAAAADWhQ0D9/2vkjwrySeq6opp7JeT/HqSt1fV85Jcm+Tp07JLkjwlyZYkX07y3CTp7pur6pVJLpvWe0V33zxw3gAAAACraliA6e4PJallFj9xifU7yZnL7Ov8JOev3uwAAAAA9p698i1IAAAAAPszAQYAAABgMAEGAAAAYDABBgAAAGAwAQYAAABgMAEGAAAAYDABBgAAAGAwAQYAAABgMAEGAAAAYDABBgAAAGAwAQYAAABgMAEGAAAAYDABBgAAAGAwAQYAAABgMAEGAAAAYDABBgAAAGCwDWs9Adif/NXrf2itp8Bgj/8/3r3WUwAAAPZBKwowVfXGJL3jeHf/5KrPCAAAAGDBrPQMmPn/pLs9xNQqzwUAAABgIa0owHT3O5Kkqh6b5LeS3D3JrwycFwAAAMDC2NV7wLw6yUuT3Jzk9Uk2rfqMAAAAABbMrgaYe3f3+5Kkqr48YD4AAAAAC2elN+H9uenhA6bHleSIYbMCAAAAWCArPQPmPtPv1889fvPqTwcAAABg8aw0wFze3e++69UAAAAA2NHdVrjeK4bOAgAAAGCBrfQMmG+vqkdmdu+Xf9bdH139KQEAAAAslpUGmCOSvCbfHGA6yQ+u+owAAAAAFsxKA8yW7hZbAAAAAHbDSu8B84WhswAAAABYYCsKMM5+AQAAANh9K7oEqaqOTfJ/Jzkuyb22j3f3dwyaFwAAAMDCWOklSG9Mcm6S25M8Icmbk7xl1KQAAAAAFslKA8y3dff7klR3X9vdL0/y1HHTAgAAAFgcK/0WpK9V1d2SXFNVZyXZmuTAcdMCAAAAWBwrPQPmhUm+PcnPJHl0kmclOX3UpAAAAAAWyYrOgOnuy5JkOgvmZ7r7tqGzAgAAAFggKzoDpqpOqKpPJPl4kk9U1ceq6tFjpwYAAACwGFZ6D5jzk/x0d/9VklTV92f2zUgPHzUxAAAAgEWx0nvA3LE9viRJd38os6+kBgAAAOAurPQMmA9U1e8neVuSTvIfkry/qh6VJN390UHzAwAAAFj3VhpgHjH9ftkO44/MLMj84KrNCAAAAGDBrDTA/Hh33zB0JgAAAAALaqX3gHnP0FkAAAAALLCVBhgAAAAAdtNKL0F6eFXdOve8knR333fAnAAAAAAWykoDzCe6+5FDZwIAAACwoFyCBAAAADDYSgPMvx86CwAAAIAFttJLkD5TVWcmeViSe20f7O6fHDIrAAAAgAWy0jNg/jDJA5OcnOQDSY5MctuoSQEAAAAskpUGmO/q7v+U5H929wVJnprkseOmBQAAALA4Vhpg/mn6fUtVfW+S+yV5wJgpAQAAACyWld4D5ryqOjjJrya5OMmBSV46bFYAAAAAC2SnAaaq7pXkRUluSXJrkickuSrJh5P8wfDZAQAAACyAu7oE6f/J7FKjh2d2890HJHlVZpcg/ebYqQEAAAAshru6BOnR3f2oqrpbkhuT/OvuvrOq/irJ5eOnBwAAALD+3dUZMP+UJN19Z5Lrp9/p7h49MQAAAIBFcZffglRV950ePm5u7Kh845uRAAAAANiJuwowz07SSdLdX50bv2eSnxo1KQAAAIBFstN7wHT3J5cZ3zJmOgAAAACL5y4vQQIAAABgzwgwAAAAAIMJMAAAAACDCTAAAAAAgwkwAAAAAIMJMAAAAACDCTAAAAAAgwkwAAAAAIMJMAAAAACDDQswVXV+Vd1UVX87N/byqtpaVVdMP0+ZW/aSqtpSVZ+sqpPnxk+ZxrZU1dmj5gsAAAAwysgzYN6U5JQlxl/b3cdPP5ckSVUdl+S0JA+btvndqjqgqg5I8jtJnpzkuCTPmNYFAAAAWDc2jNpxd3+wqo5e4eqnJrmou7+W5B+rakuSE6dlW7r7U0lSVRdN6161ytMFAAAAGGYt7gFzVlV9fLpE6eBp7Igk182tc/00ttw4AAAAwLqxtwPMuUm+M8nxSW5I8prV2nFVnVFVm6tq87Zt21ZrtwAAAAB7bK8GmO6+sbvv6O47k7w+37jMaGuSo+ZWPXIaW258qX2f190ndPcJGzduXP3JAwAAAOymvRpgqurwuac/kmT7NyRdnOS0qrpnVR2T5NgkH0lyWZJjq+qYqrpHZjfqvXhvzhkAAABgTw27CW9VvS3JDyQ5tKquT/KyJD9QVccn6SSfTvJTSdLdV1bV2zO7ue7tSc7s7jum/ZyV5L1JDkhyfndfOWrOAAAAACOM/BakZywx/IadrH9OknOWGL8kySWrODUAAACAvWotvgUJAAAAYL8iwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMJsAAAAAADCbAAAAAAAwmwAAAAAAMtmGtJwDA6viNi05e6ykw2C+d9t61ngIAALtp2BkwVXV+Vd1UVX87N3ZIVW2qqmum3wdP41VVr6uqLVX18ap61Nw2p0/rX1NVp4+aLwAAAMAoIy9BelOSU3YYOzvJ+7r72CTvm54nyZOTHDv9nJHk3GQWbJK8LMljk5yY5GXbow0AAADAejEswHT3B5PcvMPwqUkumB5fkORpc+Nv7plLkxxUVYcnOTnJpu6+ubu/kGRTvjXqAAAAAOzT9vZNeA/r7humx59Nctj0+Igk182td/00ttw4AAAAwLqxZt+C1N2dpFdrf1V1RlVtrqrN27ZtW63dAgAAAOyxvR1gbpwuLcr0+6ZpfGuSo+bWO3IaW278W3T3ed19QnefsHHjxlWfOAAAAMDu2tsB5uIk27/J6PQk75obf/b0bUgnJfnidKnSe5M8qaoOnm6++6RpDAAAAGDd2DBqx1X1tiQ/kOTQqro+s28z+vUkb6+q5yW5NsnTp9UvSfKUJFuSfDnJc5Oku2+uqlcmuWxa7xXdveONfQEAAAD2acMCTHc/Y5lFT1xi3U5y5jL7OT/J+as4NQAAAIC9as1uwgsAAACwvxBgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAG27DWEwAA9m1Pfed/XuspMNh7/t2L1noKALDwnAEDAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADCYAAMAAAAwmAADAAAAMJgAAwAAADDYmgSYqvp0VX2iqq6oqs3T2CFVtamqrpl+HzyNV1W9rqq2VNXHq+pRazFnAAAAgN21lmfAPKG7j+/uE6bnZyd5X3cfm+R90/MkeXKSY6efM5Kcu9dnCgAAALAH9qVLkE5NcsH0+IIkT5sbf3PPXJrkoKo6fC0mCAAAALA71irAdJK/qKrLq+qMaeyw7r5hevzZJIdNj49Ict3cttdPYwAAAADrwoY1et3v7+6tVfWAJJuq6u/mF3Z3V1Xvyg6nkHNGkjz4wQ9evZe5mksAAAwjSURBVJkCAAAA7KE1OQOmu7dOv29K8qdJTkxy4/ZLi6bfN02rb01y1NzmR05jO+7zvO4+obtP2Lhx48jpAwAAAOySvR5gqureVXWf7Y+TPCnJ3ya5OMnp02qnJ3nX9PjiJM+evg3ppCRfnLtUCQAAAGCftxaXIB2W5E+ravvrv7W7/2tVXZbk7VX1vCTXJnn6tP4lSZ6SZEuSLyd57t6fMgAAAMDu2+sBprs/leQRS4x/PskTlxjvJGfuhakBAAAADLEvfQ01AAAAwEISYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABtuw1hMAAGD/dOqfvHetp8Be8K4fPXmtpwCwT3AGDAAAAMBgAgwAAADAYAIMAAAAwGACDAAAAMBgAgwAAADAYAIMAAAAwGACDAAAAMBgAgwAAADAYAIMAAAAwGACDAAAAMBgAgwAAADAYAIMAAAAwGACDAAAAMBgAgwAAADAYAIMAAAAwGACDAAAAMBgAgwAAADAYAIMAAAAwGACDAAAAMBgAgwAAADAYAIMAAAAwGACDAAAAMBgAgwAAADAYBvWegIAAACr7YJ3blvrKTDY6f9u41pPAXaJM2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABtuw1hMAAACA9eKzv3ntWk+BveCBv/CQVd+nM2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABhNgAAAAAAYTYAAAAAAGE2AAAAAABls3AaaqTqmqT1bVlqo6e63nAwAAALBS6yLAVNUBSX4nyZOTHJfkGVV13NrOCgAAAGBl1kWASXJiki3d/anu/nqSi5KcusZzAgAAAFiR9RJgjkhy3dzz66cxAAAAgH1edfdaz+EuVdWPJjmlu58/PX9Wksd291lz65yR5Izp6b9I8sm9PtH169Akn1vrSbCwHF+M4thiJMcXozi2GMWxxUiOr13zkO7euOPghrWYyW7YmuSouedHTmP/rLvPS3Le3pzUoqiqzd19wlrPg8Xk+GIUxxYjOb4YxbHFKI4tRnJ8rY71cgnSZUmOrapjquoeSU5LcvEazwkAAABgRdbFGTDdfXtVnZXkvUkOSHJ+d1+5xtMCAAAAWJF1EWCSpLsvSXLJWs9jQbl0i5EcX4zi2GIkxxejOLYYxbHFSI6vVbAubsILAAAAsJ6tl3vAAAAAAKxbAsw+qKqOqqq/rKqrqurKqnrhNH5IVW2qqmum3wdP48+sqo9X1Seq6q+r6hFz+zqlqj5ZVVuq6uydvObp036vqarT58bfP21/xfTzgGW2f/T0+luq6nVVVdP4K6e5XVFVf1FVD1qtz4nds0jH19zyF1dVV9Whe/r5sPsW6diqqpdX1da57Z+yWp8Tu26Rjq1p2X+sqr+b3surVuMzYvct0vFVVX80t+2nq+qK1fqc2HULdmwdX1WXTtturqoTV+tzYvcs2PH1iKr6m2nZ/1tV912tz2mf091+9rGfJIcnedT0+D5J/j7JcUleleTsafzsJL8xPf6+JAdPj5+c5MPT4wOS/EOS70hyjyQfS3LcEq93SJJPTb8Pnh5v39/7k5ywgjl/JMlJSSrJnyd58jR+37l1fibJ763157u//yzS8TUtOyqzG3Rfm+TQtf589+efRTq2krw8yc+v9WfqZyGPrSck+W9J7jk9f8Baf777+88iHV87rPOaJC9d6893f/5ZpGMryV/MPX5Kkvev9ee7v/8s2PF1WZJ/Mz3+ySSvXOvPd9SPM2D2Qd19Q3d/dHp8W5KrkxyR5NQkF0yrXZDkadM6f93dX5jGL01y5PT4xCRbuvtT3f31JBdN+9jRyUk2dffN0342JTllpfOtqsMzCy2X9uxvzZvn5nbr3Kr3TuKmQ2tskY6vyWuT/GIcW2tuAY8t9hELdmy9IMmvd/fXprnetNL9MsaCHV/b16kkT0/ytpXul9W3YMdWJ9l+VsL9knxmpftljAU7vh6a5IPT401J/v1K97veCDD7uKo6Oskjk3w4yWHdfcO06LNJDltik+dlVhOT2V/A6+aWXT+N7eiu1nvjdCrZf9p+mtgS21+/3PZVdU5VXZfkmUleusT2rJH1fnxV1alJtnb3x5bYjjW03o+tyVnTqbrnbz99l7W3AMfWQ5M8vqo+XFUfqKrHLLE9a2QBjq/tHp/kxu6+ZontWQMLcGy9KMlvTv+mf3WSlyyxPWtkAY6vK/ON6PNjmZ3hvpAEmH1YVR2Y5B1JXrTDmSSZqmHvsP4TMvvL9EurOI1ndve/zOx/yB+f5Fm7uoPu/pXuPirJhUnOWsW5sQfW+/FVVd+e5Jcj6u1z1vuxNTk3yXcmOT7JDZmdys8aW5Bja0Nmp2+flOQXkrx9mX+ospctyPG13TPi7Jd9xoIcWy9I8rPTv+l/NskbVnFu7IEFOb5+MslPV9XlmV1O9fVVnNs+RYDZR1XV3TP7i3Rhd79zGr5xOnVr+ylcN82t//Akf5Dk1O7+/DS8Nd9cD49MsrWqHjt3g6T/fbn1kqS7t/++Lclbk5xYVQfMbf+Kad0jl9p+BxdmgU8nW08W5Pj6ziTHJPlYVX16Gv9oVT1wTz4b9syCHFvp7hu7+47uvjPJ6zM7PZc1tCjHVmb/xe+dPfORJHcmcQPxNbZAx1eq6n+1dz8hVlVxHMC/vxwjyohMixCKAtu0CXQVEv2BKDdBizYtIle2iAiiTRuRiMiggpYtpD9Q5CrXLlrVQsXSQkxpWhTSJohcRNRp8Y40DjPqpJcn934+cJg755137nlnfvNm5jf3/d5CkqeTfPb/d4SrZUSx9VyS8+v/PH4uXhPGEl+ttZOttcdba9sySx6fubKduYa1a6AQjXZhy6wo0YdJ3l3Wvy8XFlR6qx/fleR0kgeXjV/IrDjSPfmvoNL9K5xvY5IfMyumdGs/3tjvv6mPWZ/kQJLdq6x5eUGlnb1/65IxLyY5MO/9nXobU3wtG7MYRXjF1tV77rpzyZiXk3w67/2dchtZbO1Osrcf35fZ5dw17z2echtTfPXbnkjy5bz3VRtXbGVWX+ThfvxYkiPz3t+pt5HF1+3943X9Me2a9/4O9nWb9wK0Fb4oyY7MLhX7Nsmx3nYmuS3JoSQ/ZPYOChv7+A+S/LZk7OElc+3MrCL2mSSvXeScu/o35Okkz/e+m5Ic6ev4Lsl7Sdatcv/tSU7087yf/stkZhnZE32Og0m2zHt/p97GFF/LxixGAkZsXaXYSvJRkuN9ji+yJCGjia0rjK3rk3zcbzua5NF57+/U25jiq9+2P6v88aOJrSt47trR5/gmszoj2+a9v1NvI4uvl/r5TyV5MyP+x8T5BwwAAADAQNSAAQAAABiYBAwAAADAwCRgAAAAAAYmAQMAAAAwMAkYAAAAgIFJwAAAk1BVJ6rq+6o6VlU/V9Weea8JAJgOCRgAYEqebK09kOSdeS8EAJgWCRgAYCrWJ/lzaUdVbaiqQ1V1tKqOV9VTvX9fv1LmbL9a5lhV7V1tPADApVRrbd5rAAAYXFX9kmRra+1cVb2SZEOS15Pc2Fr7vao2Jfm6j2n9PnuS/NFae7t/vnCx8QAAq1mY9wIAAIZWVeuS3NxaO7f8piRvVNVDSf5JsiXJHUnOrjbVGscDACSRgAEApuHeJKdW6H82yeYk21prf1XVYpIbLjLPWscDACRRAwYAmIZnkny1Qv8tSX7tyZRHktx9iXnWOh4AIIkrYACAkauqFzKr9fJTVe3o3ZuTrEvyapLtVXU8yeEkJy8x3SdJDq5hPABAEkV4AYCR64V0F1tr+y+nHwBgCF6CBAAAADAwV8AAAKPW3zq6tdb+vpx+AIAhSMAAAAAADMxLkAAAAAAGJgEDAAAAMDAJGAAAAICBScAAAAAADEwCBgAAAGBg/wLU8EbJvHYmuAAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 1368x720 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(19,10))\n",
    "day_cost_sum['day'] = day_cost_sum['day'].dt.date\n",
    "sns.barplot(x='day', y='cost', data=day_cost_sum)\n",
    "plt.title(\"Затраты на рекламу по дням\")\n",
    "plt.xlabel(\"Дата\")\n",
    "plt.ylabel(\"Затраты\")\n",
    "plt.show;"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Вспомним, ранее мы выводили данные по активности игроков на определенную дату.  \n",
    " Покажем на графике как с течением времени ведет себя активность"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1368x720 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "avg_user_activity['date_1'] = avg_user_activity['date'].dt.date\n",
    "avg_user_activity_1 = avg_user_activity.query('date < \"2020-05-10\"')\n",
    "plt.figure(figsize=(19,10))\n",
    "sns.barplot(x='date_1', y='building', data=avg_user_activity_1)\n",
    "plt.title(\"График активности игроков по дням\")\n",
    "plt.xlabel(\"Дата\")\n",
    "plt.ylabel(\"Количество игроков\")\n",
    "plt.show;"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Мы наблюдаем, что при снижении кликов количество активности в игре растет -  \n",
    " мы привлекли игроков и удерживаем их."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='5.4.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 5.4. Посмотрим модель безубыточности проекта"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Найдем общее количество ивентов в логе"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>event</th>\n",
       "      <th>user_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>building</td>\n",
       "      <td>127956</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>finished_stage_1</td>\n",
       "      <td>5817</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>project</td>\n",
       "      <td>1866</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              event  user_id\n",
       "0          building   127956\n",
       "1  finished_stage_1     5817\n",
       "2           project     1866"
      ]
     },
     "execution_count": 72,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "event_mean_full = games_data.pivot_table(index='event', values='user_id',\\\n",
    "                              aggfunc=({'user_id':'count'})).reset_index()\n",
    "event_mean_full.sort_values(by='user_id', ascending = False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Вспомним итоговые расходы на привлечение"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "7603.58"
      ]
     },
     "execution_count": 73,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_cost.round(2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Итак, у нас 127956 показов рекламы (игроки, выбирающие метод постройки для прохождения уровня)  \n",
    " и косты на маркетинг 7603.58 (total_costs).  \n",
    " Составим модель безубыточности так, чтобы она покрывала расходы на маркетинг, так как информации по прочим  \n",
    "     постоянным и переменным расходам у нас нет."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.05942337199340415"
      ]
     },
     "execution_count": 74,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "items_sold = 127956\n",
    "revenue = 7603.576986788022\n",
    "one_unit_revenue = revenue / items_sold\n",
    "one_unit_revenue"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Один показ рекламы для наших расходов должен бы приносить нам не меньше 0.06 у.е.  \n",
    " В случае нашей модели монетизации - один показ рекламы должен стоить 0.06 у.е.  \n",
    "  Наши расходы переменные - дублем введем переменную, считающую затраты на 1 игрока."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "7603.576986788022"
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_cost"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.05942337199340415"
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "one_unit_var_costs = total_cost/items_sold\n",
    "one_unit_var_costs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Выручка: 0.05942337199340415\n",
      "Затраты: 0.05942337199340415\n",
      "Итого: 0.0\n"
     ]
    }
   ],
   "source": [
    "print('Выручка:', one_unit_revenue)\n",
    "print('Затраты:', one_unit_var_costs.sum())\n",
    "print('Итого:', one_unit_revenue - one_unit_var_costs.sum())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Если цена за показ для одного уникального игрока будет 0.06 у.е. - прибыли не будет  \n",
    " мы только покроем расходы на маркетинг в ноль.  \n",
    "  Посмотрим соотношение потенциальных показов рекламы и уникальных игроков (найдем уникальных) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>event</th>\n",
       "      <th>user_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>building</td>\n",
       "      <td>13576</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>finished_stage_1</td>\n",
       "      <td>5817</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>project</td>\n",
       "      <td>1866</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              event  user_id\n",
       "0          building    13576\n",
       "1  finished_stage_1     5817\n",
       "2           project     1866"
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "event_mean = games_data.pivot_table(index='event', values='user_id',\\\n",
    "                              aggfunc=({'user_id':'nunique'})).reset_index()\n",
    "event_mean.sort_values(by='user_id', ascending = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9.425162050677667"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_users = 127956\n",
    "nunique_users = 13576\n",
    "cnt_view = all_users/nunique_users\n",
    "cnt_view"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Игрок выполняет 9,4 действий, где и может видеть рекламу."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='5.5.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 5.5. Сделаем выводы"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Мы проанализировали воздействие проведенной рекламной компании:\n",
    "1. Больше всего игроков у нас приходит с источника Яндекс - 35%\n",
    "2. Яндекс и самый дорогой - стоит нам 29% затрат\n",
    "3. По данным видим, что рекламная активность была 3.05.2020 - далее  \n",
    " видим, что переходы по кликам снижаются, но при этом растет вовлеченность игроков -  \n",
    "  это говорит нам, что мы делаем хороший и интересный пользователю продукт.\n",
    "4. По задумке игра должна зарабатывать на рекламе - мы увидели, что количество показов рекламы к 1 игроку -  \n",
    " это соотношение 1:9,4 \n",
    " \n",
    "Получается, что для того чтобы окупить затраты - мы можем выбрать следующие действия:\n",
    " -  Каждому игроку показывать рекламу 10 раз, чтобы для него игра была бесплатной,  \n",
    " при этом цена за показ для рекламодателя должна быть не меньше 0,06 у.е.\n",
    " - Предложить игроку платную версию, например: 5,99 у.е. в месяц - играешь без рекламы и с дополнительными донатами, в виде кастомизации объектов постройки, например.\n",
    "   \n",
    "   При бесплатной версии список опций будет ограниченным, но не законченным -  \n",
    "   если оставить только платную версию для игрока, то есть вариантов продолжать играть не будет - мы потеряем игрока и испортим себе статистику.  \n",
    "   \n",
    "Думаю, логичнее предложить игроку самостоятельно выбрать формат игры, что даст нам:\n",
    "  - Приток рекламодателей - так как не все готовы/хотят платить и мы получим высокие показатели просмотров\n",
    "  - Внутри игры мы можем рекламировать и сами себя типа \"посмотри как классно может быть если заплатишь\"\n",
    "  - На вырученные с игры деньги мы можем делать круче визуал, платить крутым геймдизайнерам за генерацию идей и платить крутым программистам за реализацию, отрабатывать лучше баги, тем самым радуя наших игроков качественным продуктом.\n",
    "   "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='6.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 6. Общие выводы и рекомендации"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Мы изучили данные - посмотрели по какому сценарию игроки проходят уровень,  \n",
    " оценили затраты на рекламу и предложили модель монетизации.  \n",
    " Итак, выводы:\n",
    "1. Максимальная активность игроков приходится к выходным и на выходных днях\n",
    "2. Наш продукт интересен пользователю в течении 1й недели, далее ретеншн падает - возможно, переход на новый уровень.\n",
    "3. Игрок проходит уровень \n",
    " - Если путем строителя за 13 дней \n",
    " - Если путем воина, то за 11 дней  \n",
    "  На эти данные можно полагаться, например, так: если игрок предпочитает сражения -  \n",
    "   - Можно предложить оружие к покупке\n",
    "   - Можно предложить просмотр рекламы для получения кратковременной сверхспособности\n",
    "   - Можно за просмотр рекламы дать доп.энергию или оружие\n",
    "4. Показатель возврата высок, в первую неделю до 49% ближе к выходным\n",
    "5. Игрокам наиболее интересны постройки сборочного цеха и космодрома -  \n",
    " возможно, здесь следует сделать акцент для придумывания новых фичей.\n",
    "6. Максимально количество новых игроков пришло к нам 4.05.2020  \n",
    " после рекламной компании накануне.\n",
    "7. Максимальные затраты на маркетинг были 3.05.2020 -  \n",
    " далее при уменьшении кликов интерес к продукту не теряется - действий в игре становится только больше -  \n",
    "  игроку нравится с нами взаимодействовать.\n",
    "  \n",
    "##### Рекомендации по монетизации :\n",
    "Для того чтобы окупить затраты - мы можем выбрать следующие действия:\n",
    " - Каждому игроку показывать рекламу 10 раз, чтобы для него игра была бесплатной,\n",
    "при этом цена за показ для рекламодателя должна быть не меньше 0,06 у.е.\n",
    " - Предложить игроку платную версию, например: 5,99 у.е. в месяц - играешь без рекламы и с дополнительными донатами, в виде кастомизации объектов постройки.\n",
    "\n",
    "При бесплатной версии список опций будет ограниченным, но не законченным -\n",
    "если оставить только платную версию для игрока, то есть вариантов продолжать играть не будет - мы потеряем игрока и испортим себе статистику.\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='7.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 7. Презентация"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Ссылка на презентацию - \n",
    "https://disk.yandex.ru/i/P4ztIB4URFDzzw\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='8.-bullet'></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 8. Дашборд"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Ссылка на дашборд - https://public.tableau.com/profile/iicharkviani#!/vizhome/__16190215922070/Dashboard1"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.8"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": false,
   "sideBar": true,
   "skip_h1_title": true,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {
    "height": "calc(100% - 180px)",
    "left": "10px",
    "top": "150px",
    "width": "285.99px"
   },
   "toc_section_display": true,
   "toc_window_display": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
